"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[607],{7606:function(e,t,n){n.r(t),n.d(t,{AutoCompleteInput:function(){return ln},Avatar:function(){return tn},Button:function(){return Qt},ChatCard:function(){return ee},ChatEngine:function(){return Yt},ChatEngineContext:function(){return S},ChatEngineWrapper:function(){return N},ChatFeed:function(){return Gt},ChatHeader:function(){return it},ChatList:function(){return ne},ChatSettings:function(){return et},ChatSettingsTop:function(){return Qe},ChatSocket:function(){return K},Dot:function(){return bt},IceBreaker:function(){return ie},IsTyping:function(){return Nt},MessageBubble:function(){return St},MessageFormSocial:function(){return Rn},NewChatForm:function(){return Z},NewMessageForm:function(){return $t},OptionsSettings:function(){return Ve},PeopleSettings:function(){return Ze},PhotosSettings:function(){return Je},ScrollDownBar:function(){return Xt},Socket:function(){return B},TextInput:function(){return on},addPerson:function(){return gn},deleteChat:function(){return hn},deleteMessage:function(){return Nn},editChat:function(){return fn},editMessage:function(){return Sn},editMyData:function(){return xn},getChat:function(){return mn},getChats:function(){return sn},getChatsBefore:function(){return un},getLatestChats:function(){return dn},getLatestMessages:function(){return kn},getMessage:function(){return Cn},getMessages:function(){return yn},getMyData:function(){return bn},getOrCreateChat:function(){return pn},getOtherPeople:function(){return vn},isTyping:function(){return Mn},leaveChat:function(){return wn},newChat:function(){return cn},readMessage:function(){return _n},removePerson:function(){return qn},sendMessage:function(){return En}});var o=n(7294),r=n(6486),l=n.n(r),i=n(7606),a=n(728),s=n(8559),c=n.n(s),d=n(7085),u=n(4549),p=n(2762),m=n(7724),f=n(4616),h=n(6504),g=n(3533),q=n(4962),v=n(6139),b=n(9675),x=n(9101),w=n(3171),y=n(1223),k=n(5549),E=n(5509),C=n(6261),S=(0,o.createContext)(),N=function(e){var t=(0,o.useState)(null),n=t[0],r=t[1],l=(0,o.useState)(null),i=l[0],a=l[1],s=(0,o.useState)(""),c=s[0],d=s[1],u=(0,o.useState)(null),p=u[0],m=u[1],f=(0,o.useState)({}),h=f[0],g=f[1],q=(0,o.useState)(null),v=q[0],b=q[1],x=(0,o.useState)({}),w=x[0],y=x[1],k=(0,o.useState)(!1),E=k[0],C=k[1],_=(0,o.useState)(!1),N={conn:n,setConn:r,creds:i,setCreds:a,sessionToken:c,setSessionToken:d,chats:p,setChats:m,messages:h,setMessages:g,activeChat:v,setActiveChat:b,typingCounter:w,setTypingCounter:y,loadMoreMessages:E,setLoadMoreMessages:C,isBottomVisible:_[0],setIsBottomVisible:_[1]};return o.createElement(S.Provider,{value:N},e.children)};function M(){return(M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function T(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,z(e,t)}function z(e,t){return(z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function I(e,t){if(!e)return"";t=t||0;var n=(e=e.replace(" ","T")).substr(0,4),o=e.substr(5,2),r=e.substr(8,2),l=e.substr(11,2),i=e.substr(14,2),a=e.substr(17,2),s=new Date(n+"-"+o+"-"+r+"T"+l+":"+i+":"+a);return s.setHours(s.getHours()+t),s}var D={weekday:"short",month:"short",day:"numeric",year:"numeric"};function R(e){var t=e.toLocaleString("en-US");return t.split(" ")[1].slice(0,-3)+" "+t.slice(-2)}function A(e){return R(e)+", "+function(e){return e.toLocaleString("en-US",D)}(e)}var O=Date.now()+1e4,j=function(e){(0,o.useState)(Date.now());var t=(0,o.useState)(Date.now()+15e3)[1],n=(0,o.useContext)(i.ChatEngineContext),r=n.conn,l=n.sessionToken,s=n.chats,c=n.setChats,d=n.messages,u=n.setMessages,p=n.activeChat,m=n.setActiveChat,f=n.typingCounter,h=n.setTypingCounter,g=n.isBottomVisible;function q(t){if(s){var n=M({},s);n[t.id]=t,c(n)}e.onEditChat&&e.onEditChat(t)}(0,o.useEffect)((function(){return function(){clearInterval(0),clearInterval(0)}}),[]);var v=e.development,b=v?"ws://":"wss://",x=v?"127.0.0.1:8000":"api.chatengine.io";return l&&""!==l?o.createElement(a.X,{url:""+b+x+"/person_v4/?session_token="+l,reconnect:!0,reconnectIntervalInMilliSeconds:3e3,childRef:function(e){return e},onOpen:function(){(Date.now()>O||r.renderChatFeed||r.renderChatList)&&(console.log("Refresh"),(0,i.getLatestChats)(r,25,(function(e){return c(_.mapKeys(e,"id"))})),(0,i.getLatestMessages)(r,p,45,(function(e,t){u(M({},d,_.mapKeys(t,"created")))}))),e.onConnect&&e.onConnect(r)},onError:function(e){return console.log("Socket Error",e)},onMessage:function(n){try{var o=JSON.parse(n);if(console.log("eventJSON.action",o.action),"pong"===o.action)t(Date.now()+15e3);else if("login_error"===o.action){var l=e.projectID+"/"+e.userName+"/"+e.userSecret;localStorage.removeItem(l),e.onFailAuth&&e.onFailAuth(r)}else if("new_chat"===o.action){var a=o.data;if(s){var v=M({},s);v[a.id]=a,c(v),m(a.id)}e.onNewChat&&e.onNewChat(o.data)}else if("edit_chat"===o.action)q(o.data);else if("delete_chat"===o.action){var b=o.data;if(s&&(s[b.id]=void 0,c(s),!_.isEmpty(s))){var x=function(t){return Object.values(t).sort((function(t,n){var o=t.last_message.created?I(t.last_message.created,e.offset):I(t.created,e.offset),r=n.last_message.created?I(n.last_message.created,e.offset):I(n.created,e.offset);return new Date(r)-new Date(o)}))}(s);m(x[0]?parseInt(x[0].id):0)}e.onDeleteChat&&e.onDeleteChat(b)}else if("add_person"===o.action)q(o.data),e.onAddPerson&&e.onAddPerson(o.data);else if("remove_person"===o.action)q(o.data),e.onRemovePerson&&e.onRemovePerson(o.data);else if("new_message"===o.action){var w=o.data,y=w.id,k=w.message;if(parseInt(y)===parseInt(p)){var E=M({},d);E[k.created]=k,u(E)}k.sender_username!==e.userName&&g&&(0,i.readMessage)(r,p,k.id,(function(e){return q(e)})),e.onNewMessage&&e.onNewMessage(y,k)}else if("edit_message"===o.action){var C=o.data,S=C.id,N=C.message;S===p&&(d[N.created]=N,u(d)),e.onEditMessage&&e.onEditMessage(S,N)}else if("delete_message"===o.action){var T=o.data,z=T.id,D=T.message;z===p&&(d[D.created]=void 0,u(d)),e.onDeleteMessage&&e.onDeleteMessage(z,D)}else if("is_typing"===o.action){var R,A,O=o.data,j=O.id,F=O.person,L=M({},f);L=M({},L,((A={})[j]=M({},L[j],((R={})[F]=Date.now(),R)),A)),h(L),e.onTyping&&e.onTyping(j,F)}return Promise.resolve()}catch(fe){return Promise.reject(fe)}}.bind(undefined),onClose:function(){return console.log("Socket Closed")}}):o.createElement("div",null)};function F(e){return e&&e.development?"http://127.0.0.1:8000":"https://api.chatengine.io"}function L(e){return e?e.chatID?{"public-key":e.publicKey?e.publicKey:e.projectID,"chat-id":e.chatID,"access-key":e.chatAccessKey}:{"Public-Key":e.publicKey?e.publicKey:e.projectID,"User-Name":e.userName,"User-Secret":e.userPassword?e.userPassword:e.userSecret}:void 0}var B=function(e){var t=(0,o.useRef)(!1),n=(0,o.useState)(!1),r=n[0],l=n[1],a=(0,o.useContext)(i.ChatEngineContext),s=a.setConn,d=a.setCreds,u=a.setSessionToken;function p(){var t=e.projectID+"/"+e.userName+"/"+e.userSecret;if(null!==localStorage.getItem(t))return s(e),d(e),u(localStorage.getItem(t)),void console.log("Local fetch!");!function(e,t,n){c().get(F(e)+"/users/me/session/",{headers:L(e)}).then((function(e){t&&t(e.data)})).catch((function(e){console.log("Get or Create Session Error",e),n&&n(e)}))}(e,(function(n){s(e),d(e),u(n.token),localStorage.setItem(t,n.token)}),(function(n){n.response&&403===n.response.status&&(console.log("Your login credentials were not correct: \n\n                        Project ID: "+e.projectID+" \n\n                        Username: "+e.userName+" \n\n                        User Secret: "+e.userSecret+"\n\n                        Double check these credentials to make sure they're correct.\n\n                        If all three are correct, try resetting the username and secret in the Online Dashboard or Private API."),s(void 0),d(void 0),localStorage.removeItem(t),e.onFailAuth&&e.onFailAuth(e)),setTimeout((function(){return p()}),1e4)}))}return(0,o.useEffect)((function(){t.current||(t.current=!0,p())})),r?o.createElement("div",null):o.createElement(j,M({},e,{reRender:function(){return l(!0),void setTimeout((function(){return l(!1)}),100)}}))},P=void 0,W=15e3,H=Date.now()+1e4,$=function(e){var t=(0,o.useState)(Date.now())[0],n=(0,o.useState)(Date.now()+W),r=n[0],s=n[1],c=(0,o.useContext)(i.ChatEngineContext),d=c.conn,u=c.setConn,p=c.setCreds,m=c.chats,f=c.setChats,h=c.messages,g=c.setMessages,q=c.activeChat,v=c.setActiveChat,b=c.typingCounter,x=c.setTypingCounter;function w(t){if(m){var n=M({},m);n[t.id]=t,f(n)}e.onEditChat&&e.onEditChat(t)}(0,o.useEffect)((function(){t>r&&(console.log("shouldPongBy",r),console.log("now",t),e.reRender&&e.reRender(),s(Date.now()+W))}),[t,r]),(0,o.useEffect)((function(){return function(){clearInterval(0),clearInterval(0)}}),[]);var y=e.development,k=e.publicKey,E=e.projectID,C=e.chatID,S=e.chatAccessKey,_=y?"ws://":"wss://",N=y?"127.0.0.1:8000":"api.chatengine.io",T=k||E;return o.createElement(a.X,{reconnect:!0,childRef:function(e){return e},url:""+_+N+"/chat/?projectID="+T+"&chatID="+C+"&accessKey="+S,onOpen:function(t){u(t),p(t),(0,i.getChat)(t,e.chatID,(function(e){return function(e){null===q&&v(e.id),f(l().mapKeys([e],"id"))}(e)})),Date.now()>H&&(0,i.getLatestMessages)(t,e.chatID,45,(function(e,t){g(M({},h,l().mapKeys(t,"created")))})),e.onConnect&&e.onConnect(t)}.bind(P,e),onClose:function(){e.reRender&&e.reRender()}.bind(P),onError:function(e){return console.log("Socket Error",e)},onMessage:function(t){var n=JSON.parse(t);if("pong"===n.action)s(Date.now()+W);else if("login_error"===n.action)console.log("Your chat auth credentials were not correct: \n\n                Project ID: "+e.projectID+" \n\n                Chat ID: "+e.chatID+" \n\n                Access Key: "+e.chatAccessKey+"\n\n                Double check these credentials to make sure they're correct.\n\n                If all three are correct, try resetting the username and secret in the Online Dashboard or Private API."),u(void 0),p(void 0),e.onFailAuth&&e.onFailAuth(d);else if("edit_chat"===n.action)w(n.data);else if("delete_chat"===n.action){var o=n.data;m&&(m[o.id]=void 0,f(m)),e.onDeleteChat&&e.onDeleteChat(o)}else if("add_person"===n.action)w(n.data),e.onAddPerson&&e.onAddPerson(n.data);else if("remove_person"===n.action)w(n.data),e.onRemovePerson&&e.onRemovePerson(n.data);else if("new_message"===n.action){var r=n.data,l=r.id,i=r.message;if(l===q){var a=M({},h);a[i.created]=i,g(a)}e.onNewMessage&&e.onNewMessage(l,i)}else if("edit_message"===n.action){var c=n.data,v=c.id,y=c.message;v===q&&(h[y.created]=y,g(h)),e.onEditMessage&&e.onEditMessage(v,y)}else if("delete_message"===n.action){var k=n.data,E=k.id,C=k.message;E===q&&(h[C.created]=void 0,g(h)),e.onDeleteMessage&&e.onDeleteMessage(E,C)}else if("is_typing"===n.action){var S,_,N=n.data,T=N.id,z=N.person,I=M({},b);I=M({},I,((_={})[T]=M({},I[T],((S={})[z]=Date.now(),S)),_)),x(I),e.onTyping&&e.onTyping(T,z)}}.bind(P),reconnectIntervalInMilliSeconds:3e3})},K=function(e){var t=(0,o.useState)(!1),n=t[0],r=t[1];return o.createElement("div",null,!n&&o.createElement($,M({},e,{reRender:function(){return r(!0),void setTimeout((function(){return r(!1)}),100)}})))},X=function(e){var t=(0,o.useRef)();!function(t){var n=(0,o.useState)(!1),r=n[0],l=n[1],i=new IntersectionObserver((function(t){var n=t[0];l(n.isIntersecting),n.isIntersecting&&e.onVisible()}));(0,o.useEffect)((function(){return i.observe(t.current),function(){i.disconnect()}}),[])}(t);return o.createElement("div",{ref:t},o.createElement("div",{style:{textAlign:"center",backgroundColor:"#e2e2e2",margin:"4px",borderRadius:"4px"}},o.createElement(d.Z,{style:{fontSize:"21px",padding:"24px"}})))},Z=function(e){var t=(0,o.useContext)(S).conn,n=(0,o.useState)(""),r=n[0],l=n[1],a=(0,o.useState)(!1),s=a[0],c=a[1];return o.createElement("div",null,e.onClose&&o.createElement("div",{style:{height:"0px"}},o.createElement(u.Z,{style:G.closeIcon,onClick:function(){return e.onClose()}})),o.createElement("div",{className:"ce-chat-form-container",style:M({},G.newChatContainer,{marginLeft:e.onClose?"40px":"0px"})},s?o.createElement("form",{onSubmit:function(e){e.preventDefault(),t&&r.trim().length>0&&(0,i.newChat)(t,{title:r},(function(){return c(!1)})),l("")}.bind(undefined)},o.createElement(i.TextInput,{autoFocus:!0,label:"Chat Title",value:r,id:"ce-new-chat-title-field",onBlur:function(){return c(!1)},style:{width:"100%"},handleChange:function(e){l(e.target.value)}})):o.createElement("div",null,o.createElement("div",{style:{height:"0px"}},o.createElement("div",{style:{fontWeight:"600",fontSize:"24px",position:"relative",top:"4px",width:"calc(100% - 48px)"}},"My Chats")),o.createElement("div",{style:{width:"100%",textAlign:"right"}},o.createElement(i.Button,{icon:"plus",id:"new-chat-plus-button",onClick:function(){return c(!0)}})))))},G={closeIcon:{position:"relative",top:"26px",left:"18px",fontSize:"16px"},newChatContainer:{padding:"16px 14px",backgroundColor:"white"}},U=function(){return o.createElement("div",{style:J.chatContainer,className:"ce-chat-card ce-chat-card-loading"},o.createElement("div",{style:M({},J.titleText,{animation:"spin 2s linear infinite"}),className:"ce-chat-title-text",id:"ce-chat-card-title-loading"},o.createElement("div",{className:"ce-chat-card-loading-bar",style:M({},J.loadingBar,{marginBottom:"8px",height:"16px",width:"100%"})})),o.createElement("div",{style:{width:"100%"},className:"ce-chat-subtitle"},o.createElement("div",{style:J.messageText,className:"ce-chat-subtitle-text ce-chat-subtitle-message"},o.createElement("div",{className:"ce-chat-card-loading-bar",style:M({},J.loadingBar,{width:"45%"})})),o.createElement("div",{className:"ce-chat-card-loading-bar",style:M({},J.loadingBar,{float:"right",marginTop:"6px",width:"20%"})})))},J={chatContainer:{padding:"16px",paddingBottom:"12px",cursor:"pointer"},titleText:{fontWeight:"500",paddingBottom:"4px",whiteSpace:"nowrap",overflow:"hidden"},messageText:{width:"75%",color:"rgba(153, 153, 153, 1)",fontSize:"14px",whiteSpace:"nowrap",overflow:"hidden",display:"inline-block"},loadingBar:{borderRadius:"4px",backgroundColor:"#e2e2e2",height:"12px",display:"inline-block"}};var V=["children","triggers"],Y=function(e){var t=e.children,n=e.triggers,r=void 0===n?[]:n,l=function(e){var t=e.x,n=void 0===t?0:t,r=e.y,l=void 0===r?0:r,i=e.rotation,a=void 0===i?0:i,s=e.scale,c=void 0===s?1:s,d=e.timing,u=void 0===d?150:d,p=e.springConfig,m=void 0===p?{tension:300,friction:10}:p,f=e.width,h=void 0===f?"auto":f,g=o.useState(!1),q=g[0],v=g[1],b=(0,k.q_)({display:"inline-block",backfaceVisibility:"hidden",transform:q?"translate("+n+"px, "+l+"px)\n            rotate("+a+"deg)\n            scale("+c+")":"translate(0px, 0px)\n            rotate(0deg)\n            scale(1)",config:m,width:h});return o.useEffect((function(){if(q){var e=window.setTimeout((function(){v(!1)}),u);return function(){window.clearTimeout(e)}}}),[q]),[b,o.useCallback((function(){v(!0)}),[])]}(function(e,t){if(null==e)return{};var n,o,r={},l=Object.keys(e);for(o=0;o<l.length;o++)n=l[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,V)),i=l[0],a=l[1];function s(e){return-1!==r.indexOf(e)}return o.createElement(k.q.span,{style:i,onClick:function(){return s("onClick")&&a()},onMouseEnter:function(){return s("onMouseEnter")&&a()},onMouseLeave:function(){return s("onMouseLeave")&&a()}},t)},Q=n(2647).htmlToText,ee=function(e){var t=e.chat,n=(0,o.useContext)(i.ChatEngineContext),r=n.conn,a=n.activeChat,s=n.setActiveChat;if(l().isEmpty(t)||e.loading)return o.createElement(U,null);if(!r||null===r)return o.createElement("div",null);var c,d=a===t.id?te.activeChat:{},u=t.people.find((function(e){return r.userName!==e.person.username})),p=t.is_direct_chat&&u?u.person.username:t.title,m=Q(t.last_message.text,{});function f(e){var t=!0;return e.people.map((function(n){r.userName===n.person.username&&(t=e.last_message.id===n.last_read)})),t}return m||(m=t.last_message.attachments.length>0?t.last_message.attachments.length+" image"+(t.last_message.attachments.length>1?"s":""):"Say hello!"),o.createElement(Y,{triggers:["onClick","onMouseEnter"],x:3,timing:60,width:"-webkit-fill-available"},o.createElement("div",{onClick:function(){return s(t.id)},style:M({},te.chatContainer,d),className:"ce-chat-card "+(a===t.id&&"ce-active-chat-card")},o.createElement("div",{style:te.titleText,className:"ce-chat-title-text",id:"ce-chat-card-title-"+p},o.createElement("div",{style:{width:!f(t)&&"calc(100% - 18px)",overflowX:"hidden",display:"inline-block"}},p),!f(t)&&o.createElement("div",{className:"ce-chat-unread-dot",style:{marginTop:"5px",width:"12px",height:"12px",borderRadius:"6px",backgroundColor:"#1890ff",float:"right",display:"inline-block"}})),o.createElement("div",{style:{width:"100%"},className:"ce-chat-subtitle"},o.createElement("div",{style:te.messageText,className:"ce-chat-subtitle-text ce-chat-subtitle-message"},m),o.createElement("div",{className:"ce-chat-subtitle-text ce-chat-subtitle-date",style:M({},te.messageText,{textAlign:"right",width:"25%"})},(c=t.last_message.created)?I(c,r.offset).toString().substr(4,6):""))))},te={chatContainer:{padding:"16px",paddingBottom:"12px",cursor:"pointer"},titleText:{fontWeight:"500",paddingBottom:"4px",whiteSpace:"nowrap",overflow:"hidden"},messageText:{width:"75%",color:"rgba(153, 153, 153, 1)",fontSize:"14px",whiteSpace:"nowrap",overflow:"hidden",display:"inline-block"},activeChat:{backgroundColor:"#d9d9d9",border:"0px solid white",borderRadius:"12px"}},ne=function(e){var t=(0,o.useRef)(!1),n=(0,o.useState)(!1),r=n[0],a=n[1],s=(0,o.useState)(!0),c=s[0],d=s[1],u=(0,o.useContext)(i.ChatEngineContext),p=u.conn,m=u.chats,f=u.setChats,h=u.setActiveChat,g=q(m?Object.values(m):[{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}]);function q(t){return t.sort((function(t,n){var o=t.last_message&&t.last_message.created?I(t.last_message.created,e.offset):I(t.created,e.offset),r=n.last_message&&n.last_message.created?I(n.last_message.created,e.offset):I(n.created,e.offset);return new Date(r)-new Date(o)}))}function v(e){a(!1);var t=null!==m?m:{},n=l().mapKeys(M({},e),"id"),o=M({},t,n);f(o),33>e.length&&d(!1)}return(0,o.useEffect)((function(){t.current||(t.current=!0,(0,i.getLatestChats)(e,33,(function(e){v(e),e.length>0&&h(e[0].id)})))})),(0,o.useEffect)((function(){if(r&&"loading"!==r){a("loading");var t=null!==m?q(Object.values(m)):[];if(t.length>0){var n=t[t.length-1].created;(0,i.getChatsBefore)(e,n,33,(function(e){return v(e)}))}}}),[r]),o.createElement("div",{style:oe.chatListContainer,className:"ce-chat-list"},o.createElement("div",{style:oe.chatsContainer,className:"ce-chats-container"},e.renderNewChatForm?e.renderNewChatForm(p):o.createElement(Z,{onClose:e.onClose?function(){return e.onClose()}:void 0}),function(t){return t.map((function(t,n){return t?e.renderChatCard?o.createElement("div",{key:"chat_"+n},e.renderChatCard(t,n)):o.createElement("div",{key:"chat_"+n,onClick:function(){return e.onChatClick&&e.onChatClick(t.id)}},o.createElement(ee,{chat:t})):o.createElement("div",{key:"chat_"+n})}))}(g),c&&g.length>0&&o.createElement("div",null,o.createElement(X,{onVisible:function(){return!r&&a(!0)}}),o.createElement("div",{style:{height:"8px"}}))))},oe={chatListContainer:{height:"100%",maxHeight:"100vh",overflow:"scroll",overflowX:"hidden",borderRight:"1px solid #afafaf",backgroundColor:"white",fontFamily:"Avenir"},chatsContainer:{width:"100%",height:"100%",backgroundColor:"white",borderRadius:"0px 0px 24px 24px"}},re=function(e){var t=e.projectID?e.projectID:e.publicKey;return o.createElement("div",{id:"ce-login-fail-breaker",style:{width:"100%",textAlign:"center",paddingTop:"calc(50% - 112px)"}},o.createElement("div",{id:"ce-login-fail-text",style:{color:"#afafaf",fontWeight:"600",fontSize:"14px",marginBottom:"6px",marginRight:"32px",marginLeft:"32px"}},"Your credentials are incorrect. Make sure your Project ID, Username, and Password are correct ",o.createElement("a",{href:"https://chatengine.io/projects/"+t},"here"),"."),o.createElement("img",{id:"ce-login-fail-gif",style:{width:"50%",maxWidth:"200px"},src:"https://chat-engine-assets.s3.amazonaws.com/welcome_gifs/no.gif",alt:"chat-engine-login-fail"}))},le=function(){return o.createElement("div",{id:"ce-ice-breaker",style:{width:"100%",textAlign:"center",paddingTop:"calc(43% - 112px)"}},o.createElement("div",{id:"ce-ice-breaker-text",style:{color:"#afafaf",fontWeight:"600",marginBottom:"6px"}},"Welcome!"),o.createElement("div",{id:"ce-ice-breaker-text",style:{color:"#afafaf"}},"Create a new chat to get started."),o.createElement("img",{id:"ce-ice-breaker-gif",style:{width:"50%",maxWidth:"200px"},src:"https://chat-engine-assets.s3.amazonaws.com/welcome_gifs/okay.gif",alt:"chat-engine-ice-breaker"}))},ie=function(){var e=(0,o.useContext)(i.ChatEngineContext).activeChat,t=["https://chat-engine-assets.s3.amazonaws.com/welcome_gifs/peace.gif","https://chat-engine-assets.s3.amazonaws.com/welcome_gifs/thumbsup.gif"],n=t[(e||0)%t.length];return o.createElement("div",{id:"ce-ice-breaker",style:{width:"100%",textAlign:"center",paddingTop:"calc(43% - 112px)"}},o.createElement("div",{id:"ce-ice-breaker-text",style:{color:"#afafaf",fontWeight:"600",fontSize:"14px",marginBottom:"6px"}},"No messages here yet..."),o.createElement("img",{id:"ce-ice-breaker-gif",style:{width:"50%",maxWidth:"200px"},src:n,alt:"chat-engine-ice-breaker"}))},ae=function(e){(0,o.useContext)(S);var t=(0,o.useRef)();!function(t){var n=(0,o.useState)(!1),r=n[0],l=n[1],i=new IntersectionObserver((function(t){var n=t[0];l(n.isIntersecting),n.isIntersecting?e.onEnter&&e.onEnter():e.onLeave&&e.onLeave()}));(0,o.useEffect)((function(){return i.observe(t.current),function(){i.disconnect()}}),[])}(t);return o.createElement("div",{ref:t,id:e.id},e.children)},se=function(e){var t=(0,o.useState)(!1),n=t[0],r=t[1],l=(0,o.useContext)(S),i=M({},e,l.conn);return o.createElement("div",null,o.createElement(p.Z,{onClick:function(){return r(!0)},style:{color:"rgb(24, 144, 255)",outline:"none"}}),n&&o.createElement("div",{style:ce.drawerContainer},null!==l.conn&&l.conn.renderChatList?l.conn.renderChatList(l):o.createElement(ne,M({},i,{onClose:function(){return r(!1)},onChatClick:function(){return r(!1)}}))))},ce={drawerContainer:{position:"fixed",zIndex:"1",top:"0px",left:"0px",width:"100%",height:"100%",backgroundColor:"white",textAlign:"left"},titleContainer:{width:"100%",padding:"24px 0px",textAlign:"center",color:"rgb(24, 144, 255)"},titleText:{fontSize:"24px",fontWeight:"600"}};function de(e,t){return e(t={exports:{}},t.exports),t.exports}var ue="function"===typeof Symbol&&Symbol.for,pe=ue?Symbol.for("react.element"):60103,me=ue?Symbol.for("react.portal"):60106,fe=ue?Symbol.for("react.fragment"):60107,he=ue?Symbol.for("react.strict_mode"):60108,ge=ue?Symbol.for("react.profiler"):60114,qe=ue?Symbol.for("react.provider"):60109,ve=ue?Symbol.for("react.context"):60110,be=ue?Symbol.for("react.async_mode"):60111,xe=ue?Symbol.for("react.concurrent_mode"):60111,we=ue?Symbol.for("react.forward_ref"):60112,ye=ue?Symbol.for("react.suspense"):60113,ke=ue?Symbol.for("react.suspense_list"):60120,Ee=ue?Symbol.for("react.memo"):60115,Ce=ue?Symbol.for("react.lazy"):60116,Se=ue?Symbol.for("react.block"):60121,_e=ue?Symbol.for("react.fundamental"):60117,Ne=ue?Symbol.for("react.responder"):60118,Me=ue?Symbol.for("react.scope"):60119;function Te(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case pe:switch(e=e.type){case be:case xe:case fe:case ge:case he:case ye:return e;default:switch(e=e&&e.$$typeof){case ve:case we:case Ce:case Ee:case qe:return e;default:return t}}case me:return t}}}function ze(e){return Te(e)===xe}var Ie={AsyncMode:be,ConcurrentMode:xe,ContextConsumer:ve,ContextProvider:qe,Element:pe,ForwardRef:we,Fragment:fe,Lazy:Ce,Memo:Ee,Portal:me,Profiler:ge,StrictMode:he,Suspense:ye,isAsyncMode:function(e){return ze(e)||Te(e)===be},isConcurrentMode:ze,isContextConsumer:function(e){return Te(e)===ve},isContextProvider:function(e){return Te(e)===qe},isElement:function(e){return"object"===typeof e&&null!==e&&e.$$typeof===pe},isForwardRef:function(e){return Te(e)===we},isFragment:function(e){return Te(e)===fe},isLazy:function(e){return Te(e)===Ce},isMemo:function(e){return Te(e)===Ee},isPortal:function(e){return Te(e)===me},isProfiler:function(e){return Te(e)===ge},isStrictMode:function(e){return Te(e)===he},isSuspense:function(e){return Te(e)===ye},isValidElementType:function(e){return"string"===typeof e||"function"===typeof e||e===fe||e===xe||e===ge||e===he||e===ye||e===ke||"object"===typeof e&&null!==e&&(e.$$typeof===Ce||e.$$typeof===Ee||e.$$typeof===qe||e.$$typeof===ve||e.$$typeof===we||e.$$typeof===_e||e.$$typeof===Ne||e.$$typeof===Me||e.$$typeof===Se)},typeOf:Te},De=(de((function(e,t){0})),de((function(e){e.exports=Ie})),Object.getOwnPropertySymbols),Re=Object.prototype.hasOwnProperty,Ae=Object.prototype.propertyIsEnumerable;function Oe(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach((function(e){o[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(r){return!1}})()&&Object.assign;var je="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";function Fe(e,t,n,o,r){}Fe.resetWarningCache=function(){0};Function.call.bind(Object.prototype.hasOwnProperty);function Le(){}function Be(){}Be.resetWarningCache=Le;var Pe=de((function(e){e.exports=function(){function e(e,t,n,o,r,l){if(l!==je){var i=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw i.name="Invariant Violation",i}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Be,resetWarningCache:Le};return n.PropTypes=n,n}()})),We=function(e){var t=(0,o.useState)(!1),n=t[0],r=t[1],l=e.person,a=e.chat,s=e.conn;if(!l||!a)return o.createElement("div",null);if(!s||null===s)return o.createElement("div",null);return o.createElement("div",{className:"ce-person-container",onMouseEnter:function(){return r(!0)},onMouseLeave:function(){return r(!1)}},o.createElement("div",{className:"ce-person-avatar",style:{padding:"2px",height:"0px"}},o.createElement(i.Avatar,{avatar:l.avatar,username:l.username,is_online:l.is_online})),o.createElement("div",{className:"ce-person-text",style:{paddingLeft:"52px",height:"44px",position:"relative",top:"10px",fontSize:"15px"}},function(e){return e.first_name&&null!==e.first_name?e.first_name+(e.last_name?" "+e.last_name:""):e.username}(l)),n&&s.userName===a.admin.username&&l.username!==a.admin.username&&o.createElement("div",{className:"ce-delete-chat",style:{float:"right",height:"0px",position:"relative",bottom:"44px"}},o.createElement(i.Button,{theme:"danger",icon:"delete",onClick:function(){(0,i.removePerson)(e.conn,e.chat.id,e.person.username)}})))};We.propTypes={person:Pe.object.isRequired,chat:Pe.object.isRequired,conn:Pe.object};var He=function(e){var t=(0,o.useState)(!1),n=t[0],r=t[1],l=e.person,a=l.avatar,s=l.username;return o.createElement("div",{id:"ce-username-option-"+s,onMouseEnter:function(){return r(!0)},onMouseLeave:function(){return r(!1)},onClick:function(){return e.onClick&&e.onClick()},style:M({},$e.option,{backgroundColor:n?"#f5f5f5":"white"})},o.createElement("div",null,o.createElement(i.Avatar,{username:s,avatar:a})),o.createElement("div",{style:{display:"flex",padding:"12px 4px"}},e.person.username))},$e={option:{padding:"4px 16px",cursor:"pointer",fontSize:"15px",display:"flex"}};He.propTypes={person:Pe.object.isRequired};var Ke=function(e){var t=(0,o.useState)({value:"",others:[]}),n=t[0],r=t[1];function l(){(0,i.getOtherPeople)(e.conn,e.chat.id,(function(e,t){return r(M({},n,{others:t}))}),(function(){}))}function a(t){return o.createElement(He,{person:t,onClick:function(){return o=t.username,void(0,i.addPerson)(e.conn,e.chat.id,o,(function(){r(M({},n,{value:""})),l()}));var o}})}return o.createElement("div",{style:{marginBottom:"12px"}},o.createElement(i.AutoCompleteInput,{style:{width:"100%"},label:"Type a username",value:n.value,options:n.others,onFocus:function(){return l()},handleChange:function(e){return function(e){r(M({},n,{value:e}))}(e)},renderOption:function(e){return a(e)}}))};Ke.propTypes={chat:Pe.object.isRequired,conn:Pe.object.isRequired};var Xe=function(e){var t=(0,o.useState)(!0),n=t[0],r=t[1],l=(0,o.useState)(!1),i=l[0],a=l[1];return o.createElement("div",{style:{borderTop:"1px solid #f0f0f0"}},o.createElement("div",{id:e.id,className:e.className,onMouseEnter:function(){return a(!0)},onMouseLeave:function(){return a(!1)},onClick:function(){return r(!n)},style:{cursor:"pointer",backgroundColor:i?"#f0f0f0":"#fff",transition:"background-color 100ms"}},o.createElement("div",{style:{fontSize:"17px",padding:"12px",fontWeight:"600"}},e.label),o.createElement(m.Z,{style:{float:"right",position:"relative",bottom:"30px",right:"12px",transform:n?"rotate(0deg)":"rotate(-90deg)",transition:"transform 100ms"}})),o.createElement("div",null,!n&&e.children))},Ze=function(){var e=(0,o.useContext)(i.ChatEngineContext),t=e.conn,n=e.chats,r=e.activeChat,l=n&&n[r];if(!l||l.is_direct_chat)return o.createElement("div",null);return o.createElement("div",{style:{borderTop:"1px solid #f0f0f0"}},o.createElement(Xe,{label:"People",className:"ce-section-title-container ce-person-title-container"},o.createElement("div",null,o.createElement("div",{style:{height:"12px"}}),function(e,n){return e.map((function(e,r){return o.createElement(We,{key:"person_"+r,person:e.person,conn:t,chat:n})}))}(l.people,l),o.createElement("div",{style:{height:"12px"}}),t&&l&&t.userName===l.admin.username&&o.createElement(Ke,{conn:t,chat:l}))))},Ge=function(e){var t=e.attachment;return t?o.createElement("div",{style:Ue.container,className:"ce-photo-thumbnail"},o.createElement("div",{style:{paddingTop:"100%"}}),o.createElement("img",{alt:t.id,style:Ue.image,src:t.file,className:"ce-photo-img",id:"image-"+t.id})):o.createElement("div",null)},Ue={container:{position:"relative",width:"calc(33% - 8px)",border:"1px solid white",display:"inline-block",cursor:"pointer"},image:{top:"0px",width:"100%",height:"100%",position:"absolute",objectFit:"cover"}};Ge.propTypes={attachment:Pe.object.isRequired};var Je=function(){var e=(0,o.useContext)(i.ChatEngineContext),t=e.chats,n=e.activeChat,r=t&&t[n];if(!r)return o.createElement("div",null);return o.createElement("div",{style:{borderTop:"1px solid #f0f0f0"},className:"ce-photo-section"},o.createElement(Xe,{label:"Photos",className:"ce-section-title-container ce-photo-title-container"},o.createElement("div",{className:"ce-photo-feed"},o.createElement("div",{style:{height:"12px"}}),r.attachments.map((function(e,t){return o.createElement(Ge,{key:"person_"+t,attachment:e})})))))},Ve=function(){var e=(0,o.useContext)(i.ChatEngineContext),t=e.conn,n=e.chats,r=e.activeChat,l=n&&n[r];return l?o.createElement("div",{style:{borderTop:"1px solid #f0f0f0"}},o.createElement(Xe,{id:"ce-options-drop-down",label:"Options"},o.createElement("div",null,o.createElement("div",{style:{height:"8px"}}),o.createElement(i.Button,{value:"Delete",theme:"danger",icon:"delete",id:"ce-delete-chat-button",onClick:function(){return(0,i.deleteChat)(t,l.id,(function(e){}))},style:{width:"100%",marginBottom:"12px"}})))):o.createElement("div",null)},Ye=function(e){var t=(0,o.useRef)(!1),n=(0,o.useState)({activeChat:null,value:""}),r=n[0],l=n[1];return(0,o.useEffect)((function(){t.current?r.activeChat!==e.chat.id&&l(M({},r,{value:e.chat.title,activeChat:e.chat.id})):t.current=!0})),o.createElement("form",{onSubmit:function(t){return t.preventDefault(),void(0,i.editChat)(e.conn,e.chat.id,{title:r.value},(function(e){}))},className:"ce-chat-title-form"},o.createElement(i.TextInput,{label:"Rename this Chat",value:r.value,default:e.chat.title,handleChange:function(e){l(M({},r,{value:e.target.value}))},style:{fontSize:"16px",fontWeight:"600",textAlign:"center",border:"0px solid white",width:"100%"}}))};Ye.propTypes={chat:Pe.object.isRequired};var Qe=function(){var e=(0,o.useContext)(i.ChatEngineContext),t=e.conn,n=e.chats,r=e.activeChat,l=n&&n[r];if(!l||!t||null===t)return o.createElement("div",null);var a=l.people.slice(0,3),s=l.people.find((function(e){return e.person.username!==t.userName}));function c(e){return o.createElement("div",{style:{width:"100%",paddingTop:"14px"}},o.createElement("div",{style:{float:"left",position:"relative",left:"calc(50% - 22px)"}},o.createElement(i.Avatar,{show_online:!1,username:e[0].person.username,avatar:e[0].person.avatar})))}return o.createElement("div",{className:"ce-chat-settings-container"},o.createElement("div",{className:"ce-chat-avatars-row"},1===a.length&&c(a),l.is_direct_chat&&s&&c([s]),!l.is_direct_chat&&s&&2===a.length&&function(e){return o.createElement("div",{style:{width:"100%",paddingTop:"14px"}},o.createElement("div",{style:{float:"left",position:"relative",left:"calc(50% - 22px - 15px)"}},o.createElement(i.Avatar,{show_online:!1,username:e[0].person.username,avatar:e[0].person.avatar})),o.createElement("div",{style:{float:"left",position:"relative",left:"calc(50% - 44px - 22px + 15px)"}},o.createElement(i.Avatar,{show_online:!1,username:e[1].person.username,avatar:e[1].person.avatar})))}(a),!l.is_direct_chat&&s&&3===a.length&&function(e){return o.createElement("div",{style:{width:"100%",paddingTop:"14px"}},o.createElement("div",{style:{float:"left",position:"relative",left:"calc(50% - 22px - 24px)"}},o.createElement(i.Avatar,{show_online:!1,username:e[0].person.username,avatar:e[0].person.avatar})),o.createElement("div",{style:{float:"left",position:"relative",left:"calc(50% - 24px - 44px)"}},o.createElement(i.Avatar,{show_online:!1,username:e[1].person.username,avatar:e[1].person.avatar})),o.createElement("div",{style:{float:"left",position:"relative",left:"calc(50% - 22px - 44px - 44px + 24px)"}},o.createElement(i.Avatar,{show_online:!1,username:e[2].person.username,avatar:e[2].person.avatar})))}(a)),l.is_direct_chat&&s?o.createElement("div",{style:{paddingTop:"55px",paddingBottom:"7px",fontSize:"16px",fontWeight:"600",textAlign:"center",border:"0px solid white",width:"100%"}},s.person.username):o.createElement(Ye,{chat:l,conn:t}))},et=function(e){var t=(0,o.useContext)(i.ChatEngineContext),n=t.conn,r=t.chats,l=t.activeChat,a=r&&r[l];return null===n?o.createElement("div",null):o.createElement("div",{style:tt.settingsContainer,className:"ce-settings"},o.createElement("div",{style:{width:"90%",paddingLeft:"5%"},className:"ce-settings-container"},e.renderChatSettingsTop?e.renderChatSettingsTop(n,a):o.createElement(Qe,null),e.renderPeopleSettings?e.renderPeopleSettings(n,a):o.createElement(Ze,null),e.renderPhotosSettings?e.renderPhotosSettings(a):o.createElement(Je,null),n&&a&&n.userName===a.admin.username&&o.createElement("div",null,e.renderOptionsSettings?e.renderOptionsSettings(n,a):o.createElement(Ve,null))))},tt={settingsContainer:{height:"100%",overflow:"scroll",overflowX:"hidden",borderLeft:"1px solid #afafaf",backgroundColor:"white",fontFamily:"Avenir"}},nt=function(e){var t=(0,o.useState)(!1),n=t[0],r=t[1],l=(0,o.useContext)(i.ChatEngineContext),a=M({},e,l.conn);return o.createElement("div",null,o.createElement(f.Z,{onClick:function(){return r(!0)},style:{color:"rgb(24, 144, 255)",outline:"none"}}),n&&o.createElement("div",{style:ot.drawerContainer},o.createElement(u.Z,{style:ot.closeIcon,onClick:function(){return r(!1)}}),o.createElement("div",{style:ot.titleContainer},o.createElement("div",{style:ot.titleText},"Chat Settings")),null!==l.conn&&l.conn.renderChatSettings?l.conn.renderChatSettings(l):o.createElement(et,a)))},ot={drawerContainer:{position:"fixed",zIndex:"1",top:"0px",left:"0px",width:"100%",height:"100%",backgroundColor:"white",textAlign:"left"},closeIcon:{position:"absolute",left:"28px",top:"32px"},titleContainer:{width:"100%",padding:"24px 0px",textAlign:"center",color:"rgb(24, 144, 255)"},titleText:{fontSize:"24px",fontWeight:"600"}};(0,E.Dg)({maxScreenClass:"xl",gutterWidth:0});var rt,lt,it=function(){var e=(0,o.useContext)(i.ChatEngineContext),t=e.conn,n=e.chats,r=e.activeChat,l=n?n[r]:void 0,a=l&&t&&l.people.find((function(e){return e.person.username!==t.userName})),s=l?l.is_direct_chat&&a?a.person.username:l.title:void 0,c="Say hello!";if(l){if(l.last_message.created&&l.last_message.created.length>0){c="Active "+A(I(l.last_message.created,t?t.offset:void 0))}}else c="Loading...";return o.createElement(E.X2,{className:"ce-chat-title",style:at.titleSection},o.createElement(E.JX,{xs:2,sm:0,style:M({},at.mobileOptiom,{left:"6px"}),className:"ce-chat-list-mobile-option"},o.createElement(se,null)),o.createElement(E.JX,{xs:8,sm:12,style:at.titleContainer,className:"ce-chat-title-container"},o.createElement("div",{style:at.titleText,className:"ce-chat-title-text",id:"ce-chat-feed-title-"+s},s||o.createElement(d.Z,null)),o.createElement("div",{style:at.subtitleText,className:"ce-chat-subtitle-text"},c)),o.createElement(E.JX,{xs:2,sm:0,style:M({},at.mobileOptiom,{right:"6px"}),className:"ce-chat-settings-mobile-option"},o.createElement(nt,null)))},at={titleSection:{position:"absolute",top:"0px",width:"100%",zIndex:"1",backgroundColor:"rgb(256, 256, 256, 0.92)"},mobileOptiom:{width:"100%",top:"32px",textAlign:"center",color:"rgb(24, 144, 255)",overflow:"hidden"},titleContainer:{width:"100%",padding:"18px 0px",textAlign:"center",color:"rgb(24, 144, 255)",overflowX:"hidden"},titleText:{fontSize:"24px",fontWeight:"600"},subtitleText:{fontSize:"12px"}},st=function(e){var t=e.lastCreated,n=e.created;function r(e){return e?e.substr(0,10):null}var l=r(t),i=r(n);return t&&l===i?o.createElement("div",null):o.createElement("div",{style:ct.dateText,className:"ce-message-date-text"},A(I(n,e.offset)))},ct={dateText:{width:"100%",textAlign:"center",paddingTop:"4px",paddingBottom:"10px",fontSize:"15px",color:"rgba(0, 0, 0, .40)"}},dt=["jpg","jpeg","png","gif","tiff"],ut=function(e){var t=e.split(".");return t.length>0&&-1!==dt.indexOf(t[t.length-1].toLowerCase())},pt=function(e){var t=e.split("/");return t[t.length-1].split("?")[0]},mt=function(e){var t=(0,o.useState)(!1),n=t[0],r=t[1],l=e.attachment,i=M({},ft.thumbnail,{border:n?"1px solid #1890ff":"1px solid #fff"});return l?o.createElement("img",{onClick:function(){return window.open(l.file)},onMouseEnter:function(){return r(!0)},onMouseLeave:function(){return r(!1)},src:l.file,alt:"thumb-nail",style:i}):o.createElement("div",{style:ft.loadingContainer},o.createElement(d.Z,{style:{color:"white",padding:"4px",fontSize:"24px"}}))},ft={loadingContainer:(rt={width:"100%",cursor:"pointer",textAlign:"right",display:"inline-block",objectFit:"cover",borderRadius:"0.3em",marginRight:"2px",marginBottom:"4px",height:"30vw"},rt.width="30vw",rt.maxHeight="200px",rt.maxWidth="200px",rt.minHeight="100px",rt.minWidth="100px",rt.backgroundColor="#d9d9d9",rt),thumbnail:(lt={width:"100%",cursor:"pointer",textAlign:"right",display:"inline",objectFit:"cover",borderRadius:"0.3em",paddingRight:"2px",height:"30vw"},lt.width="30vw",lt.maxHeight="200px",lt.maxWidth="200px",lt.minHeight="100px",lt.minWidth="100px",lt)},ht=function(e){var t=(0,o.useState)(!1),n=t[0],r=t[1],l=e.attachment,i=M({},gt.fileView,{color:n?"#1890ff":"#434343",border:n?"1px solid #1890ff":"1px solid #434343"});return l?o.createElement("div",{style:i,onMouseEnter:function(){return r(!0)},onMouseLeave:function(){return r(!1)},onClick:function(){return window.open(l.file)}},o.createElement(h.Z,null)," ",pt(l.file)):o.createElement("div",{style:gt.loadingContainer},o.createElement(d.Z,{style:{color:"white",padding:"4px",fontSize:"24px"}}))},gt={loadingContainer:{display:"inline-block",borderRadius:"14px",marginRight:"2px",height:"48px",width:"136px",marginBottom:"4px",marginLeft:"4px",backgroundColor:"#d9d9d9"},fileView:{padding:"12px",borderRadius:"14px",display:"inline-block",marginBottom:"4px",marginRight:"2px",cursor:"pointer"}},qt=["#D64045","#5B3000","#00CC99","#467599","#1D3354","#8F250C","#6153CC","#961D4E","#A29F15","#0CAADC","#FF5154","#FA7921","#688E26","#550527","#A10702","#FF1053","#6C6EA0","#100B00"];function vt(e){return e?qt[function(e){for(var t=0,n=0;n<e.length;n++)t=t+e.charCodeAt(n)*n-97;return t}(e)%qt.length]:"black"}var bt=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=e.call.apply(e,[this].concat(o))||this).state={avatar:""},t}T(t,e);var n=t.prototype;return n.updateImg=function(){var e=this.props.avatar;(e=e&&null!==e?e:"").split("?")[0]!==this.state.avatar.split("?")[0]&&this.setState({avatar:e})},n.componentDidMount=function(){this.updateImg()},n.componentDidUpdate=function(){this.updateImg()},n.render=function(){var e=vt(this.props.username),t=this.props.style?this.props.style:{};return o.createElement("div",{className:"ce-avatar-dot",style:M({},xt.dot,t,{backgroundColor:this.state.avatar?"white":e,backgroundImage:this.state.avatar&&"url("+this.state.avatar+")",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"14px",width:this.props.visible?"13px":"0px",height:this.props.visible?"13px":"0px"})})},t}(o.Component),xt={dot:{borderRadius:"13px",textAlign:"center",transition:"all .33s ease",WebkitTransition:"all .33s ease",MozTransition:"all .33s ease"}};bt.propTypes={avatar:Pe.string,username:Pe.string,style:Pe.object};var wt=function(e){var t=e.text?e.text:"";return t=(t=t.replaceAll("<p>","<div>").replaceAll("</p>","</div>")).replaceAll("<a ",'<a style="color: '+(e.myMessage?"white":"#1890ff")+';" '),o.createElement("div",{className:"ce_message",dangerouslySetInnerHTML:{__html:t}})};(0,E.Dg)({maxScreenClass:"xl"});var yt=function(e){var t=(0,o.useContext)(i.ChatEngineContext).conn,n=(0,o.useState)(!1),r=n[0],l=n[1];var a=e.lastMessage,s=e.message,c=e.nextMessage;if(!s)return o.createElement("div",null);var d=s&&s.attachments&&s.attachments,u="1.3em "+(a&&a.sender_username===s.sender_username?"0.3em":"1.3em")+" "+(c&&c.sender_username===s.sender_username?"0.3em":"1.3em")+" 1.3em",p=c&&c.sender_username===s.sender_username?"2px":"12px";return o.createElement("div",{className:"ce-message-row ce-my-message",style:{width:"100%",textAlign:"right",paddingBottom:p}},o.createElement("div",{style:{display:"auto"},className:"ce-my-message-attachments-container ce-my-message-images-container"},function(){var t=e.message;return(t&&t.attachments?t.attachments:[]).map((function(e,t){var n=pt(e.file?e.file:e.name);return ut(n)?o.createElement(mt,{attachment:e.file&&e,key:"attachment_"+t}):o.createElement("div",{key:"attachment"+t})}))}()),o.createElement("div",{style:{display:"auto"},className:"ce-my-message-attachments-container ce-my-message-files-container"},function(){var t=e.message;return(t&&t.attachments?t.attachments:[]).map((function(e,t){var n=pt(e.file?e.file:e.name);return ut(n)?o.createElement("div",{key:"attachment"+t}):o.createElement(ht,{attachment:e.file&&e,key:"attachment_"+t})}))}()),o.createElement(E.X2,{style:{paddingRight:"2px"},className:"ce-message-bubble-row ce-my-message-bubble-row"},o.createElement(E.JX,{xs:12,sm:12,md:12},o.createElement("span",{className:"ce-message-timestamp ce-my-message-timestamp",style:M({},kt.timeTag,{opacity:r?"1":"0"})},R(I(s.created,null!==t&&t.offset))),!d||s.text&&o.createElement("div",{className:"\n                                ce-message-bubble \n                                ce-my-message-bubble \n                                "+(e.sending&&"ce-my-message-sinding-bubble")+"\n                            ",style:M({},kt.myMessage,{borderRadius:u},{backgroundColor:e.sending?"#40a9ff":"rgb(24, 144, 255)"}),onMouseEnter:function(){return l(!0)},onMouseLeave:function(){return l(!1)}},o.createElement(wt,{myMessage:!0,text:s.text}))),o.createElement(E.JX,{xs:1,sm:2,md:3}),o.createElement(E.JX,{xs:12,className:"ce-reads-row ce-my-reads-row"},function(){var t=e.chat,n=e.message;return t?t.people.map((function(e,t){return o.createElement(bt,{key:"read_"+t,avatar:e.person.avatar,username:e.person.username,visible:n.id===e.last_read,style:{float:"right",marginLeft:"4px"}})})):o.createElement("div",null)}())))},kt={myMessage:{color:"white",cursor:"pointer",float:"right",textAlign:"left",padding:"12px",fontSize:"15px",whiteSpace:"pre-line",overflowWrap:"anywhere",maxWidth:"calc(100% - 100px)",transition:"all .33s ease",WebkitTransition:"all .33s ease",MozTransition:"all .33s ease"},timeTag:{position:"relative",top:"calc(50% - 12px)",right:"8px",fontSize:"14px",color:"rgb(24, 144, 255)",transition:"all .15s ease",WebkitTransition:"all .15s ease",MozTransition:"all .15s ease"}};(0,E.Dg)({maxScreenClass:"xl"});var Et=function(e){var t=(0,o.useContext)(i.ChatEngineContext).conn,n=(0,o.useState)(!1),r=n[0],l=n[1];var a=e.lastMessage,s=e.message,c=e.nextMessage;if(!s)return o.createElement("div",null);var d=s&&s.attachments&&s.attachments,u=(a&&a.sender_username===s.sender_username?"0.3em":"1.3em")+" 1.3em 1.3em "+(c&&c.sender_username===s.sender_username?"0.3em":"1.3em"),p=c&&c.sender_username===s.sender_username?"2px":"12px";return o.createElement("div",{style:{width:"100%",paddingBottom:p},className:"ce-message-row ce-their-message"},(!a||a.sender_username!==s.sender_username)&&o.createElement("div",{style:Ct.nameText,className:"ce-their-message-sender"},s.sender_username),o.createElement(E.X2,{style:{paddingLeft:"2px"},className:"ce-their-message-row"},o.createElement(E.JX,{xs:12,sm:12,md:12},o.createElement("div",{style:{height:"0px"},className:"ce-their-message-avatar"},(!c||c.sender_username!==s.sender_username)&&o.createElement(i.Avatar,{show_online:!1,username:s.sender_username,avatar:s.sender&&s.sender.avatar})),o.createElement("div",{style:{display:"auto",paddingLeft:"50px"},className:"ce-their-message-attachments-container ce-their-message-images-container"},function(){var t=e.message;return(t&&t.attachments?t.attachments:[]).map((function(e,t){var n=pt(e.file);return ut(n)?o.createElement(mt,{attachment:e,key:"attachment_"+t}):o.createElement("div",{key:"attachment"+t})}))}()),o.createElement("div",{style:{display:"auto",paddingLeft:"50px"},className:"ce-their-message-attachments-container ce-their-message-files-container"},function(){var t=e.message;return(t&&t.attachments?t.attachments:[]).map((function(e,t){var n=pt(e.file);return ut(n)?o.createElement("div",{key:"attachment"+t}):o.createElement(ht,{attachment:e,key:"attachment_"+t})}))}()),!d||s.text&&o.createElement("div",{style:{paddingLeft:"48px"}},o.createElement("div",{className:"ce-message-bubble ce-their-message-bubble",style:M({},Ct.theirMessage,{borderRadius:u}),onMouseEnter:function(){return l(!0)},onMouseLeave:function(){return l(!1)}},o.createElement(wt,{text:s.text}))),o.createElement("span",{className:"ce-message-timestamp ce-their-message-timestamp",style:M({},Ct.timeTag,{opacity:r?"1":"0"})},R(I(s.created,null!==t&&t.offset)))),o.createElement(E.JX,{xs:9,style:{marginLeft:"48px"},className:"ce-reads-row ce-their-reads-row"},function(){var t=e.chat,n=e.message;return t?t.people.map((function(e,t){return o.createElement(i.Dot,{key:"read_"+t,avatar:e.person.avatar,username:e.person.username,visible:n.id===e.last_read,style:{float:"left",marginLeft:"4px"}})})):o.createElement("div",null)}())))},Ct={theirMessage:{cursor:"pointer",color:"black",float:"left",padding:"12px",fontSize:"15px",whiteSpace:"pre-line",backgroundColor:"#f1f0f0",overflowWrap:"anywhere",maxWidth:"calc(100% - 100px)",transition:"all .33s ease",WebkitTransition:"all .33s ease",MozTransition:"all .33s ease"},nameText:{paddingLeft:"62px",paddingBottom:"2px",color:"rgba(0, 0, 0, .40)",fontSize:"15px"},timeTag:{position:"relative",top:"calc(50% - 12px)",left:"8px",fontSize:"14px",color:"rgba(0, 0, 0, 0.4)",transition:"all .15s ease",WebkitTransition:"all .15s ease",MozTransition:"all .15s ease"}},St=function(e){var t=e.lastMessage,n=e.message,r=e.nextMessage,l=e.chat,i=(0,o.useContext)(S).conn;return n&&l&&i&&null!==i?o.createElement("div",{className:"ce-message-and-date"},o.createElement(st,{lastCreated:t?t.created:null,created:n.created,offset:i.offset}),n.sender_username===i.userName||n.sender_username===i.senderUsername?o.createElement(yt,{chat:l,conn:i,sending:!n.id,lastMessage:t,message:n,nextMessage:r}):o.createElement(Et,{chat:l,conn:i,lastMessage:t,message:n,nextMessage:r})):o.createElement("div",null)},_t=function(e){var t=(0,o.useContext)(S),n=t.conn,r=t.chats,l=t.messages,i=t.activeChat,a=t.setIsBottomVisible,s=r&&r[i],c=Object.keys(l);return n&&null!==n&&s?c.map((function(t,r){var i=l[t],d=0===r?null:c[r-1],u=r===c.length-1?null:c[r+1];return e.renderMessageBubble?o.createElement("div",{key:"message_"+r},r===c.length-1&&o.createElement(ae,{id:"ce-first-message-render-trigger",onEnter:function(){return a(!0)},onLeave:function(){return a(!1)}}),e.renderMessageBubble(n,s,l[d],i,l[u])):o.createElement("div",{key:"message_"+r,id:"ce-message-"+i.id},r===c.length-1&&o.createElement(ae,{id:"ce-last-message-render-trigger",onEnter:function(){return a(!0)},onLeave:function(){return a(!1)}}),o.createElement(St,{chat:s,message:i,lastMessage:l[d],nextMessage:l[u]}))})):o.createElement("div",null)},Nt=function(){var e=(0,o.useRef)(!1),t=(0,o.useState)(Date.now()),n=t[0],r=t[1],l=(0,o.useContext)(S),i=l.conn,a=l.activeChat,s=l.typingCounter,c=s&&s[a]?s[a]:[];return(0,o.useEffect)((function(){e.current||(e.current=!0,setInterval((function(){r(Date.now())}),1e3))})),i&&null!==i?o.createElement("div",null,Object.keys(c).map((function(e,t){return i.userName!==e&&n<c[e]+2e3?o.createElement("div",{key:"typer_"+t,className:"ce-user-typing-text",style:{color:vt(e),padding:"2px",paddingLeft:"12px"}},e+" is typing..."):o.createElement("div",{key:"typer_"+t})}))):o.createElement("div",null)},Mt=["jpg","jpeg","png","gif","tiff"],Tt=function(e){var t=e.split(".");return t.length>0&&-1!==Mt.indexOf(t[t.length-1].toLowerCase())},zt=function(e){var t=(0,o.useState)(!1),n=t[0],r=t[1];return o.createElement("div",{onMouseEnter:function(){return r(!0)},onMouseLeave:function(){return r(!1)},style:M({},It.filePreview,{paddingRight:n?"6px":"26px"})},o.createElement(h.Z,null)," ",e.file&&e.file.name," "," ",n&&o.createElement(g.Z,{style:It.closeIcon,onClick:function(){return e.onRemove&&e.onRemove()}}))},It={filePreview:{padding:"12px",display:"inline-block",position:"relative",border:"1px solid #40a9ff",color:"#434343",borderRadius:"14px"},closeIcon:{}},Dt=function(e){return o.createElement("div",{className:"ce-message-files-row",style:{width:"100%",padding:e.files.lenth>0?"6px 16px":"0px"}},e.files.map((function(t,n){return Tt(t.name)?o.createElement("div",{key:"no_file_"+n}):o.createElement(zt,{file:t,key:"thumb_"+n,onRemove:function(){return e.onRemove&&e.onRemove(n)}})})))},Rt=function(e){var t=(0,o.useState)(!1),n=t[0],r=t[1],l=(0,o.useState)(""),i=l[0],a=l[1];return(0,o.useEffect)((function(){a(URL.createObjectURL(e.file))}),[e.file]),o.createElement("div",{style:{padding:"6px",display:"inline-block",position:"relative"},onMouseEnter:function(){return r(!0)},onMouseLeave:function(){return r(!1)}},o.createElement("img",{style:At.imageSquare,alt:e.file?e.file.name:"",src:i}),n&&o.createElement(g.Z,{style:At.closeIcon,onClick:function(){return e.onRemove&&e.onRemove()}}))},At={imageSquare:{height:"108px",width:"108px",border:"1px solid #afafaf",borderRadius:"8px",objectFit:"cover",display:"inline"},closeIcon:{position:"absolute",bottom:"calc(100% - 32px)",left:"96px",width:"0px",cursor:"pointer"}},Ot=function(e){return o.createElement("div",{className:"ce-message-images-row",style:{width:"100%",paddingLeft:"12px"}},e.files.map((function(t,n){return Tt(t.name)?o.createElement(Rt,{file:t,key:"thumb_"+n,onRemove:function(){return e.onRemove&&e.onRemove(n)}}):o.createElement("div",{key:"no_thumb_"+n})})))},jt=function(e){var t=(0,o.useState)({hovered:!1}),n=t[0],r=t[1];return o.createElement("form",{className:"uploader",encType:"multipart/form-data",style:{height:"0px"}},o.createElement("label",{htmlFor:"files",id:"upload-document-button"},o.createElement(q.Z,{className:"ce-attachment-icon",onMouseEnter:function(){return r(M({},n,{hovered:!0}))},onMouseLeave:function(){return r(M({},n,{hovered:!1}))},style:M({},Ft.icon,{color:n.hovered?"#06c":"#444"})})),o.createElement("input",{multiple:!0,id:"files",style:{visibility:"hidden"},type:"file",onChange:function(t){return function(t){var n=Array.from(t.target.files);e.onSelectFiles&&e.onSelectFiles(n)}(t)},onClick:function(e){return e.target.value=null}}))},Ft={icon:{background:"none",border:"none",cursor:"pointer",display:"inline-block",float:"left",height:"24px",padding:"4px 5px",width:"28px"}},Lt=function(){var e=(0,o.useState)(!1),t=e[0],n=e[1];return o.createElement("div",{style:{height:"0px"}},o.createElement("div",{id:"ce-send-message-button",onMouseEnter:function(){return n(!0)},onMouseLeave:function(){return n(!1)},style:{cursor:"pointer",backgroundColor:t?"#40a9ff":"#1890ff",display:"inline-block",padding:"5px 9px",borderRadius:"8px"}},o.createElement(v.Z,{style:{color:"white"}})))},Bt={toolbar:{container:"#toolbar"}},Pt=["bold","italic","underline","strike","code","list","bullet","indent","link","code"],Wt=function(e){function t(t){var o;return o=e.call(this,t)||this,document&&(o.quill=n(1167)),o}return T(t,e),t.prototype.render=function(){var e=this,t=this.quill;return t?o.createElement("div",{className:"ce-quill-container"},o.createElement(t,{theme:"snow",modules:Bt,formats:Pt,value:this.props.value,onChange:this.props.onChange,onKeyDown:function(t){13===t.keyCode&&e.props.onSubmit()}}),o.createElement("div",{id:"toolbar"},o.createElement("button",{className:"ql-bold"}),o.createElement("button",{className:"ql-italic"}),o.createElement("button",{className:"ql-underline"}),o.createElement("button",{className:"ql-strike"}),o.createElement("button",{className:"ql-code"}),o.createElement("button",{className:"ql-link"}),o.createElement(jt,{onSelectFiles:function(t){return e.props.onAttach(t)}}),o.createElement("div",{className:"ce-send-button-container",onClick:this.props.onSubmit.bind(this),style:{position:"absolute",right:"5px",bottom:"37px"}},o.createElement(Lt,null))),o.createElement("style",null,"\n                /*!\n                * Quill Editor v1.3.7\n                * https://quilljs.com/\n                * Copyright (c) 2014, Jason Chen\n                * Copyright (c) 2013, salesforce.com\n                */\n                .ql-container{box-sizing:border-box;font-family:Helvetica,Arial,sans-serif;font-size:13px;height:100%;margin:0;position:relative}.ql-container.ql-disabled .ql-tooltip{visibility:hidden}.ql-container.ql-disabled .ql-editor ul[data-checked]>li::before{pointer-events:none}.ql-clipboard{left:-100000px;height:1px;overflow-y:hidden;position:absolute;top:50%}.ql-clipboard p{margin:0;padding:0}.ql-editor{box-sizing:border-box;line-height:1.42;height:100%;outline:0;overflow-y:auto;padding:12px 15px;tab-size:4;-moz-tab-size:4;text-align:left;white-space:pre-wrap;word-wrap:break-word}.ql-editor>*{cursor:text}.ql-editor blockquote,.ql-editor h1,.ql-editor h2,.ql-editor h3,.ql-editor h4,.ql-editor h5,.ql-editor h6,.ql-editor ol,.ql-editor p,.ql-editor pre,.ql-editor ul{margin:0;padding:0;counter-reset:list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}.ql-editor ol,.ql-editor ul{padding-left:1.5em}.ql-editor ol>li,.ql-editor ul>li{list-style-type:none}.ql-editor ul>li::before{content:{};}.ql-editor ul[data-checked=false]{pointer-events:none}.ql-editor ul[data-checked=false]>li *,.ql-editor ul[data-checked=true]>li *{pointer-events:all}.ql-editor ul[data-checked=false]>li::before,.ql-editor ul[data-checked=true]>li::before{color:#777;cursor:pointer;pointer-events:all}.ql-editor ul[data-checked=true]>li::before{content:{};}.ql-editor li:not(.ql-direction-rtl)::before{margin-left:-1.5em;margin-right:.3em;text-align:right}.ql-editor li.ql-direction-rtl::before{margin-left:.3em;margin-right:-1.5em}.ql-editor ol li:not(.ql-direction-rtl),.ql-editor ul li:not(.ql-direction-rtl){padding-left:1.5em}.ql-editor ol li.ql-direction-rtl,.ql-editor ul li.ql-direction-rtl{padding-right:1.5em}.ql-editor ol li{counter-reset:list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9;counter-increment:list-0}.ql-editor ol li:before{content:counter(list-0,decimal) '. '}.ql-editor ol li.ql-indent-1{counter-increment:list-1}.ql-editor ol li.ql-indent-1:before{content:counter(list-1,lower-alpha) '. '}.ql-editor ol li.ql-indent-1{counter-reset:list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}.ql-editor ol li.ql-indent-2{counter-increment:list-2}.ql-editor ol li.ql-indent-2:before{content:counter(list-2,lower-roman) '. '}.ql-editor ol li.ql-indent-2{counter-reset:list-3 list-4 list-5 list-6 list-7 list-8 list-9}.ql-editor ol li.ql-indent-3{counter-increment:list-3}.ql-editor ol li.ql-indent-3:before{content:counter(list-3,decimal) '. '}.ql-editor ol li.ql-indent-3{counter-reset:list-4 list-5 list-6 list-7 list-8 list-9}.ql-editor ol li.ql-indent-4{counter-increment:list-4}.ql-editor ol li.ql-indent-4:before{content:counter(list-4,lower-alpha) '. '}.ql-editor ol li.ql-indent-4{counter-reset:list-5 list-6 list-7 list-8 list-9}.ql-editor ol li.ql-indent-5{counter-increment:list-5}.ql-editor ol li.ql-indent-5:before{content:counter(list-5,lower-roman) '. '}.ql-editor ol li.ql-indent-5{counter-reset:list-6 list-7 list-8 list-9}.ql-editor ol li.ql-indent-6{counter-increment:list-6}.ql-editor ol li.ql-indent-6:before{content:counter(list-6,decimal) '. '}.ql-editor ol li.ql-indent-6{counter-reset:list-7 list-8 list-9}.ql-editor ol li.ql-indent-7{counter-increment:list-7}.ql-editor ol li.ql-indent-7:before{content:counter(list-7,lower-alpha) '. '}.ql-editor ol li.ql-indent-7{counter-reset:list-8 list-9}.ql-editor ol li.ql-indent-8{counter-increment:list-8}.ql-editor ol li.ql-indent-8:before{content:counter(list-8,lower-roman) '. '}.ql-editor ol li.ql-indent-8{counter-reset:list-9}.ql-editor ol li.ql-indent-9{counter-increment:list-9}.ql-editor ol li.ql-indent-9:before{content:counter(list-9,decimal) '. '}.ql-editor .ql-indent-1:not(.ql-direction-rtl){padding-left:3em}.ql-editor li.ql-indent-1:not(.ql-direction-rtl){padding-left:4.5em}.ql-editor .ql-indent-1.ql-direction-rtl.ql-align-right{padding-right:3em}.ql-editor li.ql-indent-1.ql-direction-rtl.ql-align-right{padding-right:4.5em}.ql-editor .ql-indent-2:not(.ql-direction-rtl){padding-left:6em}.ql-editor li.ql-indent-2:not(.ql-direction-rtl){padding-left:7.5em}.ql-editor .ql-indent-2.ql-direction-rtl.ql-align-right{padding-right:6em}.ql-editor li.ql-indent-2.ql-direction-rtl.ql-align-right{padding-right:7.5em}.ql-editor .ql-indent-3:not(.ql-direction-rtl){padding-left:9em}.ql-editor li.ql-indent-3:not(.ql-direction-rtl){padding-left:10.5em}.ql-editor .ql-indent-3.ql-direction-rtl.ql-align-right{padding-right:9em}.ql-editor li.ql-indent-3.ql-direction-rtl.ql-align-right{padding-right:10.5em}.ql-editor .ql-indent-4:not(.ql-direction-rtl){padding-left:12em}.ql-editor li.ql-indent-4:not(.ql-direction-rtl){padding-left:13.5em}.ql-editor .ql-indent-4.ql-direction-rtl.ql-align-right{padding-right:12em}.ql-editor li.ql-indent-4.ql-direction-rtl.ql-align-right{padding-right:13.5em}.ql-editor .ql-indent-5:not(.ql-direction-rtl){padding-left:15em}.ql-editor li.ql-indent-5:not(.ql-direction-rtl){padding-left:16.5em}.ql-editor .ql-indent-5.ql-direction-rtl.ql-align-right{padding-right:15em}.ql-editor li.ql-indent-5.ql-direction-rtl.ql-align-right{padding-right:16.5em}.ql-editor .ql-indent-6:not(.ql-direction-rtl){padding-left:18em}.ql-editor li.ql-indent-6:not(.ql-direction-rtl){padding-left:19.5em}.ql-editor .ql-indent-6.ql-direction-rtl.ql-align-right{padding-right:18em}.ql-editor li.ql-indent-6.ql-direction-rtl.ql-align-right{padding-right:19.5em}.ql-editor .ql-indent-7:not(.ql-direction-rtl){padding-left:21em}.ql-editor li.ql-indent-7:not(.ql-direction-rtl){padding-left:22.5em}.ql-editor .ql-indent-7.ql-direction-rtl.ql-align-right{padding-right:21em}.ql-editor li.ql-indent-7.ql-direction-rtl.ql-align-right{padding-right:22.5em}.ql-editor .ql-indent-8:not(.ql-direction-rtl){padding-left:24em}.ql-editor li.ql-indent-8:not(.ql-direction-rtl){padding-left:25.5em}.ql-editor .ql-indent-8.ql-direction-rtl.ql-align-right{padding-right:24em}.ql-editor li.ql-indent-8.ql-direction-rtl.ql-align-right{padding-right:25.5em}.ql-editor .ql-indent-9:not(.ql-direction-rtl){padding-left:27em}.ql-editor li.ql-indent-9:not(.ql-direction-rtl){padding-left:28.5em}.ql-editor .ql-indent-9.ql-direction-rtl.ql-align-right{padding-right:27em}.ql-editor li.ql-indent-9.ql-direction-rtl.ql-align-right{padding-right:28.5em}.ql-editor .ql-video{display:block;max-width:100%}.ql-editor .ql-video.ql-align-center{margin:0 auto}.ql-editor .ql-video.ql-align-right{margin:0 0 0 auto}.ql-editor .ql-bg-black{background-color:#000}.ql-editor .ql-bg-red{background-color:#e60000}.ql-editor .ql-bg-orange{background-color:#f90}.ql-editor .ql-bg-yellow{background-color:#ff0}.ql-editor .ql-bg-green{background-color:#008a00}.ql-editor .ql-bg-blue{background-color:#06c}.ql-editor .ql-bg-purple{background-color:#93f}.ql-editor .ql-color-white{color:#fff}.ql-editor .ql-color-red{color:#e60000}.ql-editor .ql-color-orange{color:#f90}.ql-editor .ql-color-yellow{color:#ff0}.ql-editor .ql-color-green{color:#008a00}.ql-editor .ql-color-blue{color:#06c}.ql-editor .ql-color-purple{color:#93f}.ql-editor .ql-font-serif{font-family:Georgia,Times New Roman,serif}.ql-editor .ql-font-monospace{font-family:Monaco,Courier New,monospace}.ql-editor .ql-size-small{font-size:.75em}.ql-editor .ql-size-large{font-size:1.5em}.ql-editor .ql-size-huge{font-size:2.5em}.ql-editor .ql-direction-rtl{direction:rtl;text-align:inherit}.ql-editor .ql-align-center{text-align:center}.ql-editor .ql-align-justify{text-align:justify}.ql-editor .ql-align-right{text-align:right}.ql-editor.ql-blank::before{color:rgba(0,0,0,.6);content:attr(data-placeholder);font-style:italic;left:15px;pointer-events:none;position:absolute;right:15px}.ql-snow .ql-toolbar:after,.ql-snow.ql-toolbar:after{clear:both;content:'';display:table}.ql-snow .ql-toolbar button,.ql-snow.ql-toolbar button{background:0 0;border:none;cursor:pointer;display:inline-block;float:left;height:24px;padding:3px 5px;width:28px}.ql-snow .ql-toolbar button svg,.ql-snow.ql-toolbar button svg{float:left;height:100%}.ql-snow .ql-toolbar button:active:hover,.ql-snow.ql-toolbar button:active:hover{outline:0}.ql-snow .ql-toolbar input.ql-image[type=file],.ql-snow.ql-toolbar input.ql-image[type=file]{display:none}.ql-snow .ql-toolbar .ql-picker-item.ql-selected,.ql-snow .ql-toolbar .ql-picker-item:hover,.ql-snow .ql-toolbar .ql-picker-label.ql-active,.ql-snow .ql-toolbar .ql-picker-label:hover,.ql-snow .ql-toolbar button.ql-active,.ql-snow .ql-toolbar button:focus,.ql-snow .ql-toolbar button:hover,.ql-snow.ql-toolbar .ql-picker-item.ql-selected,.ql-snow.ql-toolbar .ql-picker-item:hover,.ql-snow.ql-toolbar .ql-picker-label.ql-active,.ql-snow.ql-toolbar .ql-picker-label:hover,.ql-snow.ql-toolbar button.ql-active,.ql-snow.ql-toolbar button:focus,.ql-snow.ql-toolbar button:hover{color:#06c}.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-fill,.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-stroke.ql-fill,.ql-snow .ql-toolbar .ql-picker-item:hover .ql-fill,.ql-snow .ql-toolbar .ql-picker-item:hover .ql-stroke.ql-fill,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-fill,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-stroke.ql-fill,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-fill,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-stroke.ql-fill,.ql-snow .ql-toolbar button.ql-active .ql-fill,.ql-snow .ql-toolbar button.ql-active .ql-stroke.ql-fill,.ql-snow .ql-toolbar button:focus .ql-fill,.ql-snow .ql-toolbar button:focus .ql-stroke.ql-fill,.ql-snow .ql-toolbar button:hover .ql-fill,.ql-snow .ql-toolbar button:hover .ql-stroke.ql-fill,.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-fill,.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-stroke.ql-fill,.ql-snow.ql-toolbar .ql-picker-item:hover .ql-fill,.ql-snow.ql-toolbar .ql-picker-item:hover .ql-stroke.ql-fill,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-fill,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-stroke.ql-fill,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-fill,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-stroke.ql-fill,.ql-snow.ql-toolbar button.ql-active .ql-fill,.ql-snow.ql-toolbar button.ql-active .ql-stroke.ql-fill,.ql-snow.ql-toolbar button:focus .ql-fill,.ql-snow.ql-toolbar button:focus .ql-stroke.ql-fill,.ql-snow.ql-toolbar button:hover .ql-fill,.ql-snow.ql-toolbar button:hover .ql-stroke.ql-fill{fill:#06c}.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-stroke,.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-stroke-miter,.ql-snow .ql-toolbar .ql-picker-item:hover .ql-stroke,.ql-snow .ql-toolbar .ql-picker-item:hover .ql-stroke-miter,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-stroke,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-stroke-miter,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-stroke,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-stroke-miter,.ql-snow .ql-toolbar button.ql-active .ql-stroke,.ql-snow .ql-toolbar button.ql-active .ql-stroke-miter,.ql-snow .ql-toolbar button:focus .ql-stroke,.ql-snow .ql-toolbar button:focus .ql-stroke-miter,.ql-snow .ql-toolbar button:hover .ql-stroke,.ql-snow .ql-toolbar button:hover .ql-stroke-miter,.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-stroke,.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-stroke-miter,.ql-snow.ql-toolbar .ql-picker-item:hover .ql-stroke,.ql-snow.ql-toolbar .ql-picker-item:hover .ql-stroke-miter,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-stroke,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-stroke-miter,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-stroke,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-stroke-miter,.ql-snow.ql-toolbar button.ql-active .ql-stroke,.ql-snow.ql-toolbar button.ql-active .ql-stroke-miter,.ql-snow.ql-toolbar button:focus .ql-stroke,.ql-snow.ql-toolbar button:focus .ql-stroke-miter,.ql-snow.ql-toolbar button:hover .ql-stroke,.ql-snow.ql-toolbar button:hover .ql-stroke-miter{stroke:#06c}@media (pointer:coarse){.ql-snow .ql-toolbar button:hover:not(.ql-active),.ql-snow.ql-toolbar button:hover:not(.ql-active){color:#444}.ql-snow .ql-toolbar button:hover:not(.ql-active) .ql-fill,.ql-snow .ql-toolbar button:hover:not(.ql-active) .ql-stroke.ql-fill,.ql-snow.ql-toolbar button:hover:not(.ql-active) .ql-fill,.ql-snow.ql-toolbar button:hover:not(.ql-active) .ql-stroke.ql-fill{fill:#444}.ql-snow .ql-toolbar button:hover:not(.ql-active) .ql-stroke,.ql-snow .ql-toolbar button:hover:not(.ql-active) .ql-stroke-miter,.ql-snow.ql-toolbar button:hover:not(.ql-active) .ql-stroke,.ql-snow.ql-toolbar button:hover:not(.ql-active) .ql-stroke-miter{stroke:#444}}.ql-snow{box-sizing:border-box}.ql-snow *{box-sizing:border-box}.ql-snow .ql-hidden{display:none}.ql-snow .ql-out-bottom,.ql-snow .ql-out-top{visibility:hidden}.ql-snow .ql-tooltip{position:absolute;transform:translateY(10px)}.ql-snow .ql-tooltip a{cursor:pointer;text-decoration:none}.ql-snow .ql-tooltip.ql-flip{transform:translateY(-10px)}.ql-snow .ql-formats{display:inline-block;vertical-align:middle}.ql-snow .ql-formats:after{clear:both;content:'';display:table}.ql-snow .ql-stroke{fill:none;stroke:#444;stroke-linecap:round;stroke-linejoin:round;stroke-width:2}.ql-snow .ql-stroke-miter{fill:none;stroke:#444;stroke-miterlimit:10;stroke-width:2}.ql-snow .ql-fill,.ql-snow .ql-stroke.ql-fill{fill:#444}.ql-snow .ql-empty{fill:none}.ql-snow .ql-even{fill-rule:evenodd}.ql-snow .ql-stroke.ql-thin,.ql-snow .ql-thin{stroke-width:1}.ql-snow .ql-transparent{opacity:.4}.ql-snow .ql-direction svg:last-child{display:none}.ql-snow .ql-direction.ql-active svg:last-child{display:inline}.ql-snow .ql-direction.ql-active svg:first-child{display:none}.ql-snow .ql-editor h1{font-size:2em}.ql-snow .ql-editor h2{font-size:1.5em}.ql-snow .ql-editor h3{font-size:1.17em}.ql-snow .ql-editor h4{font-size:1em}.ql-snow .ql-editor h5{font-size:.83em}.ql-snow .ql-editor h6{font-size:.67em}.ql-snow .ql-editor a{text-decoration:underline}.ql-snow .ql-editor blockquote{border-left:4px solid #ccc;margin-bottom:5px;margin-top:5px;padding-left:16px}.ql-snow .ql-editor code,.ql-snow .ql-editor pre{background-color:#f0f0f0;border-radius:3px}.ql-snow .ql-editor pre{white-space:pre-wrap;margin-bottom:5px;margin-top:5px;padding:5px 10px}.ql-snow .ql-editor code{font-size:85%;padding:2px 4px}.ql-snow .ql-editor pre.ql-syntax{background-color:#23241f;color:#f8f8f2;overflow:visible}.ql-snow .ql-editor img{max-width:100%}.ql-snow .ql-picker{color:#444;display:inline-block;float:left;font-size:14px;font-weight:500;height:24px;position:relative;vertical-align:middle}.ql-snow .ql-picker-label{cursor:pointer;display:inline-block;height:100%;padding-left:8px;padding-right:2px;position:relative;width:100%}.ql-snow .ql-picker-label::before{display:inline-block;line-height:22px}.ql-snow .ql-picker-options{background-color:#fff;display:none;min-width:100%;padding:4px 8px;position:absolute;white-space:nowrap}.ql-snow .ql-picker-options .ql-picker-item{cursor:pointer;display:block;padding-bottom:5px;padding-top:5px}.ql-snow .ql-picker.ql-expanded .ql-picker-label{color:#ccc;z-index:2}.ql-snow .ql-picker.ql-expanded .ql-picker-label .ql-fill{fill:#ccc}.ql-snow .ql-picker.ql-expanded .ql-picker-label .ql-stroke{stroke:#ccc}.ql-snow .ql-picker.ql-expanded .ql-picker-options{display:block;margin-top:-1px;top:100%;z-index:1}.ql-snow .ql-color-picker,.ql-snow .ql-icon-picker{width:28px}.ql-snow .ql-color-picker .ql-picker-label,.ql-snow .ql-icon-picker .ql-picker-label{padding:2px 4px}.ql-snow .ql-color-picker .ql-picker-label svg,.ql-snow .ql-icon-picker .ql-picker-label svg{right:4px}.ql-snow .ql-icon-picker .ql-picker-options{padding:4px 0}.ql-snow .ql-icon-picker .ql-picker-item{height:24px;width:24px;padding:2px 4px}.ql-snow .ql-color-picker .ql-picker-options{padding:3px 5px;width:152px}.ql-snow .ql-color-picker .ql-picker-item{border:1px solid transparent;float:left;height:16px;margin:2px;padding:0;width:16px}.ql-snow .ql-picker:not(.ql-color-picker):not(.ql-icon-picker) svg{position:absolute;margin-top:-9px;right:0;top:50%;width:18px}.ql-snow .ql-picker.ql-font .ql-picker-item[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-font .ql-picker-label[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-header .ql-picker-label[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-size .ql-picker-item[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-size .ql-picker-label[data-label]:not([data-label=''])::before{content:attr(data-label)}.ql-snow .ql-picker.ql-header{width:98px}.ql-snow .ql-picker.ql-header .ql-picker-item::before,.ql-snow .ql-picker.ql-header .ql-picker-label::before{content:'Normal'}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"1\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"1\"]::before{content:'Heading 1'}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"2\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"2\"]::before{content:'Heading 2'}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"3\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"3\"]::before{content:'Heading 3'}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"4\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"4\"]::before{content:'Heading 4'}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"5\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"5\"]::before{content:'Heading 5'}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"6\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"6\"]::before{content:'Heading 6'}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"1\"]::before{font-size:2em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"2\"]::before{font-size:1.5em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"3\"]::before{font-size:1.17em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"4\"]::before{font-size:1em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"5\"]::before{font-size:.83em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"6\"]::before{font-size:.67em}.ql-snow .ql-picker.ql-font{width:108px}.ql-snow .ql-picker.ql-font .ql-picker-item::before,.ql-snow .ql-picker.ql-font .ql-picker-label::before{content:'Sans Serif'}.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=serif]::before,.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=serif]::before{content:'Serif'}.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=monospace]::before,.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=monospace]::before{content:'Monospace'}.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=serif]::before{font-family:Georgia,Times New Roman,serif}.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=monospace]::before{font-family:Monaco,Courier New,monospace}.ql-snow .ql-picker.ql-size{width:98px}.ql-snow .ql-picker.ql-size .ql-picker-item::before,.ql-snow .ql-picker.ql-size .ql-picker-label::before{content:'Normal'}.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=small]::before,.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=small]::before{content:'Small'}.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=large]::before,.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=large]::before{content:'Large'}.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=huge]::before,.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=huge]::before{content:'Huge'}.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=small]::before{font-size:10px}.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=large]::before{font-size:18px}.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=huge]::before{font-size:32px}.ql-snow .ql-color-picker.ql-background .ql-picker-item{background-color:#fff}.ql-snow .ql-color-picker.ql-color .ql-picker-item{background-color:#000}.ql-toolbar.ql-snow{border:1px solid #ccc;box-sizing:border-box;font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;padding:8px}.ql-toolbar.ql-snow .ql-formats{margin-right:15px}.ql-toolbar.ql-snow .ql-picker-label{border:1px solid transparent}.ql-toolbar.ql-snow .ql-picker-options{border:1px solid transparent;box-shadow:rgba(0,0,0,.2) 0 2px 8px}.ql-toolbar.ql-snow .ql-picker.ql-expanded .ql-picker-label{border-color:#ccc}.ql-toolbar.ql-snow .ql-picker.ql-expanded .ql-picker-options{border-color:#ccc}.ql-toolbar.ql-snow .ql-color-picker .ql-picker-item.ql-selected,.ql-toolbar.ql-snow .ql-color-picker .ql-picker-item:hover{border-color:#000}.ql-toolbar.ql-snow+.ql-container.ql-snow{border-top:0}.ql-snow .ql-tooltip{background-color:#fff;border:1px solid #ccc;box-shadow:0 0 5px #ddd;color:#444;padding:5px 12px;white-space:nowrap}.ql-snow .ql-tooltip::before{content:\"Visit URL:\";line-height:26px;margin-right:8px}.ql-snow .ql-tooltip input[type=text]{display:none;border:1px solid #ccc;font-size:13px;height:26px;margin:0;padding:3px 5px;width:170px}.ql-snow .ql-tooltip a.ql-preview{display:inline-block;max-width:200px;overflow-x:hidden;text-overflow:ellipsis;vertical-align:top}.ql-snow .ql-tooltip a.ql-action::after{border-right:1px solid #ccc;content:'Edit';margin-left:16px;padding-right:8px}.ql-snow .ql-tooltip a.ql-remove::before{content:'Remove';margin-left:8px}.ql-snow .ql-tooltip a{line-height:26px}.ql-snow .ql-tooltip.ql-editing a.ql-preview,.ql-snow .ql-tooltip.ql-editing a.ql-remove{display:none}.ql-snow .ql-tooltip.ql-editing input[type=text]{display:inline-block}.ql-snow .ql-tooltip.ql-editing a.ql-action::after{border-right:0;content:'Save';padding-right:0}.ql-snow .ql-tooltip[data-mode=link]::before{content:\"Enter link:\"}.ql-snow .ql-tooltip[data-mode=formula]::before{content:\"Enter formula:\"}.ql-snow .ql-tooltip[data-mode=video]::before{content:\"Enter video:\"}.ql-snow a{color:#06c}.ql-container.ql-snow{border:1px solid #ccc}\n                ")):o.createElement("div",null)},t}(o.Component),Ht=void 0,$t=function(){var e=(0,o.useContext)(i.ChatEngineContext),t=e.conn,n=e.activeChat,r=e.messages,l=e.setMessages,a=(0,o.useState)(0),s=a[0],c=a[1],d=(0,o.useState)(""),u=d[0],p=d[1],m=(0,o.useState)(0),f=m[0],h=m[1],g=(0,o.useState)([]),q=g[0],v=g[1];function b(e){var t=q;t.splice(e,1),v(t),c(s+1)}return o.createElement("div",{id:"msg-form-container",style:Kt.NewMessageFormContainer,className:"ce-message-form-container"},o.createElement(Ot,{files:q,onRemove:function(e){return b(e)}}),o.createElement(Dt,{files:q,onRemove:function(e){return b(e)}}),o.createElement(Wt,{theme:"snow",value:u,onChange:function(e){p(e),h((f+1)%4),1===f&&t&&(0,i.isTyping)(t,n)}.bind(Ht),onSubmit:function(){if(t){var e=u.trim();e.length>11&&"<p><br></p>"===e.slice(-11)&&(e=e.substr(0,e.length-11));var o={sender_id:Date.now().toString()},a=t.userName?t.userName:t.senderUsername,s=(new Date).toISOString().replace("T"," ").replace("Z",Math.floor(1e3*Math.random())+"+00:00"),c={text:e,attachments:q,custom_json:o,sender_username:a,chat:n,created:s};(e.length>0||q.length>0)&&(0,i.sendMessage)(t,n,c,(function(){})),p(""),v([]);var d=M({},r);d[c.created]=c,l(d)}}.bind(Ht),onAttach:v.bind(Ht)}))},Kt={NewMessageFormContainer:{position:"absolute",bottom:"0px",width:"100%",backgroundColor:"white"}},Xt=function(e){var t=(0,o.useRef)(!1),n=(0,o.useState)(!1),r=n[0],l=n[1],a=(0,o.useContext)(i.ChatEngineContext),s=a.conn,c=a.isBottomVisible,d=e.chat;if((0,o.useEffect)((function(){t.current||(t.current=!0,setTimeout((function(){return l(!0)}),e.renderDelay?e.renderDelay:0))})),null===s||!d||null===d)return o.createElement("div",null);var u=void 0;return d.people.map((function(e){e.person.username===s.userName&&(u=e.last_read)})),!r||c||void 0===d.last_message.id||d.last_message.id===u?o.createElement("div",null):o.createElement("div",{style:{zIndex:"1",bottom:"94px",left:"calc(50% - 78px)",position:"absolute",fontSize:"15px",padding:"10px 22px",color:"white",backgroundColor:"#389e0d",borderRadius:"1.3em",cursor:"pointer"},id:"ce-scroll-down-bar",onClick:function(){return C.NY.scrollToBottom({duration:333,containerId:"ce-feed-container"})}},o.createElement(b.Z,null),s.userName?" Unread Messages":" Scroll to Bottom")},Zt=45,Gt=function(e){var t=(0,o.useState)(!1),n=t[0],r=t[1],a=(0,o.useState)(null),s=a[0],c=a[1],d=(0,o.useContext)(i.ChatEngineContext),u=d.conn,p=d.chats,m=d.setChats,f=d.messages,h=d.setMessages,g=d.activeChat,q=d.setActiveChat,v=d.loadMoreMessages,b=d.setLoadMoreMessages,x=d.isBottomVisible,w=d.typingCounter,y=w&&w[g]?w[g]:[],k=p&&p[s],E=n&&l().isEmpty(f);function S(e){if(p){var t=M({},p);t[e.id]=e,m(t)}}function _(t,n,o){if(r(!0),h(l().mapKeys(n,"created")),n.length>0){var a=n[n.length-1];e.userName&&e.userName!==a.sender_username&&(0,i.readMessage)(u,t,a.id,(function(e){return S(e)}))}o&&C.NY.scrollToBottom({duration:0,containerId:o}),e.onGetMessages&&e.onGetMessages(t,n)}function N(t){t?(Zt+=33,b(!1),(0,i.getLatestMessages)(u,g,Zt,(function(e,t){return _(e,t,!1)}))):u&&!e.activeChat&&null!==g&&g!==s?(Zt=45,c(g),(0,i.getLatestMessages)(u,g,Zt,(function(e,t){return _(e,t,"ce-feed-container")}))):u&&e.activeChat&&e.activeChat!==s&&(Zt=45,q(e.activeChat),c(e.activeChat),(0,i.getLatestMessages)(u,e.activeChat,Zt,(function(e,t){return _(e,t,"ce-feed-container")})))}function T(e,t){var n=void 0;return t.people.map((function(t){t.person.username===e&&(n=t.last_read)})),n}return(0,o.useEffect)((function(){N(!1)}),[u,g,s]),(0,o.useEffect)((function(){N(v)}),[v]),(0,o.useEffect)((function(){x&&!l().isEmpty(f)&&(setTimeout((function(){C.NY.scrollToBottom({duration:333,containerId:"ce-feed-container"})}),100),T(u.userName,k)&&T(u.userName,k)!==k.last_message.id&&(0,i.readMessage)(u,s,k.last_message.id,(function(e){return S(e)})))}),[f,x]),void 0===u?o.createElement(re,e):u&&null!==p&&l().isEmpty(p)?o.createElement(le,null):o.createElement("div",{className:"ce-chat-feed",style:{height:"100%",maxHeight:"100vh",backgroundColor:"#f0f0f0"}},e.renderChatHeader?e.renderChatHeader(k):o.createElement(it,null),o.createElement("div",{id:"ce-feed-container",style:Ut.feedContainer,className:"ce-chat-feed-container"},o.createElement("div",{style:{height:"88px"},className:"ce-feed-container-top"}),Object.keys(f).length>0&&o.createElement(ae,{onEnter:function(){return b(!0)}}),E&&e.renderIceBreaker&&e.renderIceBreaker(k),E&&!e.renderIceBreaker&&o.createElement(ie,null),o.createElement(_t,e),e.renderIsTyping?e.renderIsTyping(y):o.createElement(Nt,null),e.renderScrollDownBar?e.renderScrollDownBar(k):o.createElement(Xt,{chat:k,renderDelay:3e3}),o.createElement("div",{style:{height:"86px"},className:"ce-feed-container-bottom"})),e.renderNewMessageForm?e.renderNewMessageForm(e,s):o.createElement($t,null))},Ut={feedContainer:{width:"100%",height:"100%",maxHeight:"100vh",overflowX:"hidden",overflowY:"scroll",backgroundColor:"white"}};(0,E.Dg)({maxScreenClass:"xl",gutterWidth:0});var Jt,Vt=function(e){var t=(0,o.useContext)(S),n=e.height,r=M({},e,t);return o.createElement("div",{className:"ce-chat-engine",style:{textAlign:"left",backgroundColor:"white"}},o.createElement(B,e),o.createElement(E.X2,{className:"ce-wrapper"},o.createElement(E.JX,{xs:0,sm:3,style:{height:n||""},className:"ce-chat-list-column"},e.renderChatList?e.renderChatList(r):o.createElement(ne,M({},r,{onChatClick:function(n){e.renderChatFeed&&(0,i.getLatestMessages)(e,n,45,(function(e,n){t.setMessages(M({},l().mapKeys(n,"created")))}))}}))),o.createElement(E.JX,{xs:12,sm:6,style:{height:n||""},className:"ce-chat-feed-column"},e.renderChatFeed?e.renderChatFeed(r):o.createElement(Gt,r)),o.createElement(E.JX,{xs:0,sm:3,style:{height:n||""},className:"ce-settings-column"},e.renderChatSettings?e.renderChatSettings(e):o.createElement(et,e))))},Yt=function(e){return(0,o.useContext)(S)?o.createElement(Vt,e):o.createElement(N,null,o.createElement(Vt,e))},Qt=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=e.call.apply(e,[this].concat(o))||this).state={hovered:!1},t}return T(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.value,r=t.icon,l=t.theme,i=t.style,a=t.id,s=t.type,c=t.onClick,d=i||{},u=this.state.hovered?en.hoverButton:{},p="danger"===l?en.dangerButton:en.button;return o.createElement("button",{id:a,type:s,onClick:function(){return c&&c()},onMouseEnter:function(){return e.setState({hovered:!0})},onMouseLeave:function(){return e.setState({hovered:!1})},style:M({},p,d,u),className:"ce-primary-button "+("danger"===l?"ce-danger-button":"")},"plus"===r&&o.createElement(x.Z,null),"delete"===r&&o.createElement(w.Z,null),"user-add"===r&&o.createElement(y.Z,null),n&&r?" "+n:n)},t}(o.Component),en={button:{color:"white",border:"none",outline:"none",height:"36px",fontSize:"15px",cursor:"pointer",padding:"8px 16px",borderRadius:"33px",backgroundColor:"#1890ff"},dangerButton:(Jt={color:"red",border:"none",outline:"none",height:"36px",fontSize:"15px",cursor:"pointer",padding:"8px 16px",borderRadius:"33px",backgroundColor:"white"},Jt.border="1px solid red",Jt),hoverButton:{opacity:"0.66"}};Qt.propTypes={value:Pe.string,onClick:Pe.func,style:Pe.object,id:Pe.string,icon:Pe.oneOf([void 0,"plus","delete","user-add"]),theme:Pe.oneOf([void 0,"danger"]),type:Pe.oneOf([void 0,"submit"])};var tn=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=e.call.apply(e,[this].concat(o))||this).state={avatar:""},t}T(t,e);var n=t.prototype;return n.updateImg=function(){var e=this.props.avatar;(e=e&&null!==e?e:"").split("?")[0]!==this.state.avatar.split("?")[0]&&this.setState({avatar:e})},n.componentDidMount=function(){this.updateImg()},n.componentDidUpdate=function(){this.updateImg()},n.render=function(){var e=this.props,t=e.username,n=e.is_online,r=this.props.style?this.props.style:{},l=t?t.substring(0,2).toUpperCase():"",i=vt(t);return o.createElement("div",{style:{width:"48px",height:"48px"}},o.createElement("div",{style:{height:"0px"}},o.createElement("div",{className:"ce-avatar",style:M({},nn.avatar,r,{backgroundColor:this.state.avatar?"white":i,backgroundImage:this.state.avatar&&"url("+this.state.avatar+")",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"48px"})},o.createElement("div",{className:"ce-avatar-text",style:nn.avatarText},!this.state.avatar&&l))),!1!==this.props.show_online&&o.createElement("div",{className:"ce-avatar-status",style:M({},nn.status,{backgroundColor:n?"#52c41a":"#f5222d"})}))},t}(o.Component),nn={avatar:{width:"44px",height:"44px",borderRadius:"22px",color:"white",textAlign:"center"},avatarText:{color:"white",paddingTop:"12px",fontSize:"15px",fontWeight:"600"},status:{width:"8px",height:"8px",borderRadius:"100%",border:"2px solid white"}};tn.propTypes={avatar:Pe.string,username:Pe.string,style:Pe.object,is_online:Pe.bool,show_online:Pe.bool};var on=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=e.call.apply(e,[this].concat(o))||this).state={focused:!1,value:null},t}T(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props.default;if(e){var t={target:{value:e}};this.props.handleChange(t),this.setState({value:e})}},n.render=function(){var e=this,t=this.props.style?this.props.style:{},n=this.state.focused?rn.focusInput:rn.input;return o.createElement("input",{id:this.props.id,autoFocus:this.props.autoFocus,className:"ce-input ce-text-input",value:this.props.value,placeholder:this.props.label,style:M({},n,t),onBlur:function(){e.setState({focused:!1}),e.props.onBlur&&e.props.onBlur()},onFocus:function(){e.setState({focused:!0}),e.props.onFocus&&e.props.onFocus()},type:this.props.type?this.props.type:"text",onChange:function(t){return e.props.handleChange&&e.props.handleChange(t)}})},t}(o.Component),rn={input:{height:"36px",fontSize:"15px",outline:"none",borderRadius:"24px",border:"1px solid #d9d9d9",padding:"0px 12px",boxSizing:"border-box"},focusInput:{height:"36px",fontSize:"15px",outline:"none",borderRadius:"24px",border:"1px solid #1890ff",padding:"0px 12px",boxSizing:"border-box"}};on.propTypes={default:Pe.string,value:Pe.string,label:Pe.string,type:Pe.oneOf(["text","password","number"]),autoFocus:Pe.bool,id:Pe.string,style:Pe.object,handleChange:Pe.func,onFocus:Pe.func,onBlur:Pe.func};var ln=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=e.call.apply(e,[this].concat(o))||this).state={focused:!1,showAll:!1},t}T(t,e);var n=t.prototype;return n.onFocus=function(){this.onChange("",!0),this.setState({focused:!0}),this.props.onFocus&&this.props.onFocus()},n.onBlur=function(){this.setState({focused:!1}),this.props.onBlur&&this.props.onBlur()},n.onChange=function(e,t){this.setState({showAll:t}),this.props.handleChange&&this.props.handleChange(e)},n.getNames=function(){var e=this,t=0,n=this.props.max?this.props.max:3,o=[];return this.props.options.map((function(r){-1!==JSON.stringify(r).toLowerCase().indexOf(e.props.value.toLowerCase())&&t<n&&(t+=1,o.push(r))})),o},n.renderOptions=function(){var e=this;if(!this.props.value&&!this.state.showAll)return o.createElement("div",null);var t=this.getNames();return t.map((function(n,r){return o.createElement("div",{key:"option_"+r,className:"ce-autocomplete-option"},e.props.renderOption&&e.props.renderOption(n),r===t.length-1&&o.createElement("div",{style:an.close,className:"ce-autocomplete-close",onClick:function(){return e.onChange("",!1)}},o.createElement(u.Z,null)))}))},n.render=function(){var e=this,t=this.props.options,n=this.props.style?this.props.style:{},r=M({},an.input,{border:this.state.focused?"1px solid #1890ff":"1px solid #d9d9d9"});return o.createElement("div",null,o.createElement("input",{id:"ce-add-username-input",className:"ce-input ce-autocomplete-input",value:this.props.value,placeholder:this.props.label,style:M({},r,n),type:this.props.type?this.props.type:"text",onBlur:function(){return e.onBlur()},onFocus:function(){return e.onFocus()},onChange:function(t){return e.onChange(t.target.value,!0)}}),t&&t.length>0&&this.state.showAll&&o.createElement("div",{className:"ce-autocomplete-options",style:{borderRadius:"19px",border:"1px solid #afafaf",overflow:"hidden"}},this.props.options&&this.renderOptions()))},t}(o.Component),an={input:{height:"36px",fontSize:"15px",outline:"none",borderRadius:"24px",padding:"0px 12px",boxSizing:"border-box",fontFamily:"Avenir"},close:{cursor:"pointer",textAlign:"center",padding:"8px 12px",fontSize:"15px",borderRadius:"24px"}};function sn(e,t){c().get(F(e)+"/chats/",{headers:L(e)}).then((function(n){e.onGetChats&&e.onGetChats(n.data),t&&t(n.data)})).catch((function(e){console.log("Fetch Chats Error",e)}))}function cn(e,t,n){c().post(F(e)+"/chats/",t,{headers:L(e)}).then((function(e){n&&n(e.data)})).catch((function(e){console.log("New Chat Error",e)}))}function dn(e,t,n){c().get(F(e)+"/chats/latest/"+t+"/",{headers:L(e)}).then((function(t){e.onGetChats&&e.onGetChats(t.data),n&&n(t.data)})).catch((function(e){console.log("Fetch Chats Error",e)}))}function un(e,t,n,o){c().put(F(e)+"/chats/latest/"+n+"/",{before:t},{headers:L(e)}).then((function(t){e.onGetChats&&e.onGetChats(t.data),o&&o(t.data)})).catch((function(e){console.log("Fetch Chats Before Error",e)}))}function pn(e,t,n){c().put(F(e)+"/chats/",t,{headers:L(e)}).then((function(e){n&&n(e.data)})).catch((function(e){console.log("Get or Create Chat Error",e)}))}function mn(e,t,n){c().get(F(e)+"/chats/"+t+"/",{headers:L(e)}).then((function(e){n&&n(e.data)})).catch((function(e){console.log("Get Chat Error",e)}))}function fn(e,t,n,o){c().patch(F(e)+"/chats/"+t+"/",n,{headers:L(e)}).then((function(e){o&&o(e.data)})).catch((function(e){console.log("Edit Chat Error",e)}))}function hn(e,t,n){c().delete(F(e)+"/chats/"+t+"/",{headers:L(e)}).then((function(e){n&&n(e.data)})).catch((function(e){console.log("Delete Chat Error",e)}))}function gn(e,t,n,o){c().post(F(e)+"/chats/"+t+"/people/",{username:n},{headers:L(e)}).then((function(e){o&&o(e.data)})).catch((function(e){console.log("New Person Error",e)}))}function qn(e,t,n,o){c().put(F(e)+"/chats/"+t+"/people/",{username:n},{headers:L(e)}).then((function(e){o&&o(e.data)})).catch((function(e){console.log("Delete Person Error",e)}))}function vn(e,t,n,o){c().get(F(e)+"/chats/"+t+"/others/",{headers:L(e)}).then((function(o){e.onGetOtherPeople&&e.onGetOtherPeople(t,o.data),n&&n(t,o.data)})).catch((function(e){console.log("Fetch Other People Error",e),o&&o()}))}function bn(e,t){c().get(F(e)+"/users/me/",{headers:L(e)}).then((function(e){t&&t(e.data)})).catch((function(e){console.log("Get Myself Error",e)}))}function xn(e,t,n){c().patch(F(e)+"/chats/me/",t,{headers:L(e)}).then((function(e){n&&n(e.data)})).catch((function(e){console.log("Edit Myself Error",e)}))}function wn(e,t,n){c().delete(F(e)+"/chats/"+t+"/people/",{headers:L(e)}).then((function(e){n&&n(e.data)})).catch((function(e){console.log("Delete Person Error",e)}))}function yn(e,t,n){c().get(F(e)+"/chats/"+t+"/messages/",{headers:L(e)}).then((function(o){e.onGetMessages&&e.onGetMessages(t,o.data),n&&n(t,o.data)})).catch((function(e){console.log("Fetch Messages Error",e)}))}function kn(e,t,n,o){L(e)&&c().get(F(e)+"/chats/"+t+"/messages/latest/"+n+"/",{headers:L(e)}).then((function(n){e.onGetMessages&&e.onGetMessages(t,n.data),o&&o(t,n.data)})).catch((function(e){console.log("Fetch Latest Messages Error",e)}))}function En(e,t,n,o){var r=new FormData;if(n.attachments)for(var l=0;l<n.attachments.length;l++)r.append("attachments",n.attachments[l],n.attachments[l].name);else if(n.files)for(var i=0;i<n.files.length;i++)r.append("attachments",n.files[i],n.files[i].name);n.created&&r.append("created",n.created),r.append("text",n.text),r.append("sender_username",n.sender_username),r.append("custom_json",JSON.stringify(n.custom_json?n.custom_json:{})),c().post(F(e)+"/chats/"+t+"/messages/",r,{headers:L(e)}).then((function(e){o&&o(e.data)})).catch((function(e){console.log("Send Messages Error",e)}))}function Cn(e,t,n,o){c().get(F(e)+"/chats/"+t+"/messages/"+n+"/",{headers:L(e)}).then((function(e){o&&o(t,e.data)})).catch((function(e){console.log("Fetch Message Error",e)}))}function Sn(e,t,n,o,r){c().patch(F(e)+"/chats/"+t+"/messages/"+n+"/",o,{headers:L(e)}).then((function(e){r&&r(e.data)})).catch((function(e){console.log("Delete Messages Error",e)}))}function _n(e,t,n,o){c().patch(F(e)+"/chats/"+t+"/people/",{last_read:n},{headers:L(e)}).then((function(e){o&&o(e.data)})).catch((function(e){console.log("Read Message Error",e)}))}function Nn(e,t,n,o){c().delete(F(e)+"/chats/"+t+"/messages/"+n+"/",{headers:L(e)}).then((function(e){o&&o(e.data)})).catch((function(e){console.log("Delete Messages Error",e)}))}function Mn(e,t,n){c().post(F(e)+"/chats/"+t+"/typing/",{},{headers:L(e)}).then((function(e){n&&n(e.data)})).catch((function(e){}))}ln.propTypes={default:Pe.string,value:Pe.string,options:Pe.arrayOf(Pe.object),max:Pe.number,label:Pe.string,type:Pe.oneOf(["text","number"]),style:Pe.object,handleChange:Pe.func,onFocus:Pe.func,onBlur:Pe.func};var Tn=function(e){var t,n=(0,o.useState)({hovered:!1}),r=n[0],l=n[1];return o.createElement("div",((t={className:"uploader",encType:"multipart/form-data",style:{height:"0px"}}).className="ce-upload-document-form",t),o.createElement("label",{htmlFor:"files",id:"ce-upload-document-button"},o.createElement(q.Z,{id:"ce-upload-document-icon",onMouseEnter:function(){return l(M({},r,{hovered:!0}))},onMouseLeave:function(){return l(M({},r,{hovered:!1}))},style:M({},{cursor:"pointer",position:"absolute",bottom:"20px",right:"63px",fontSize:"18px"},{color:r.hovered?"#69c0ff":"#1890ff"})})),o.createElement("input",{id:"files",accept:"image/x-png,image/gif,image/jpeg",style:{visibility:"hidden"},type:"file",onChange:function(t){return function(t){var n=Array.from(t.target.files);e.onSelectFiles&&e.onSelectFiles(n)}(t)},onClick:function(e){return e.target.value=null}}))},zn=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=e.call.apply(e,[this].concat(o))||this).state={value:null,height:0},t}T(t,e);var n=t.prototype;return n.resize=function(){var e=document.getElementById("msg-textarea");e.style.height="",e.style.height=Math.min(e.scrollHeight,150)+"px",this.setState({height:Math.min(e.scrollHeight,150)})},n.componentDidMount=function(){this.resize()},n.handleChange=function(e){this.resize(),this.props.handleChange&&this.props.handleChange(e)},n.onKeyDown=function(e){"Enter"===e.key&&(e.preventDefault(),this.props.value.length>0&&this.props.onSubmit&&this.props.onSubmit(e))},n.render=function(){var e=this;return o.createElement("input",{id:"msg-textarea",className:"ce-input ce-textarea-input",style:In.input,value:this.props.value,placeholder:this.props.label,onChange:function(t){return e.handleChange(t)},onKeyDown:function(t){return e.onKeyDown(t)}})},t}(o.Component),In={input:{border:"1px solid white",width:"calc(100% - 100px)",outline:"none",fontSize:"15px",fontFamily:"Avenir",paddingLeft:"12px",paddingRight:"12px",position:"relative",left:"12px",resize:"none",overflowX:"hidden"}},Dn=void 0,Rn=function(){var e=(0,o.useContext)(i.ChatEngineContext),t=e.conn,n=e.activeChat,r=e.messages,l=e.setMessages,a=(0,o.useState)(0),s=a[0],c=a[1],d=(0,o.useState)(""),u=d[0],p=d[1],m=(0,o.useState)(0),f=m[0],h=m[1],g=(0,o.useState)([]),q=g[0],v=g[1];if(!t||null===t)return o.createElement("div",null);function b(e){var t=q;t.splice(e,1),v(t),c(s+1)}function x(e){if(e.preventDefault(),t){var o=u.trim();o.length>11&&"<p><br></p>"===o.slice(-11)&&(o=o.substr(0,o.length-11));var a={sender_id:Date.now().toString()},s=t.userName?t.userName:t.senderUsername,c=(new Date).toISOString().replace("T"," ").replace("Z",Math.floor(1e3*Math.random())+"+00:00"),d={text:o,attachments:q,custom_json:a,sender_username:s,chat:n,created:c};(o.length>0||q.length>0)&&(0,i.sendMessage)(t,n,d,(function(){})),p(""),v([]);var m=M({},r);m[d.created]=d,l(m)}}return o.createElement("div",{id:"ce-social-msg-form-container",style:An.messageFormContainer,className:"ce-social-message-form-container"},o.createElement(Ot,{files:q,onRemove:function(e){return b(e)}}),o.createElement(Dt,{files:q,onRemove:function(e){return b(e)}}),o.createElement("form",{onSubmit:x.bind(Dn),className:"ce-social-message-form",style:An.messageForm},o.createElement("button",{icon:"send",type:"submit",id:"ce-send-message-button",style:An.sendMessage},o.createElement("img",{className:"send-icon",style:An.sendIcon,src:"https://chat-engine-assets.s3.amazonaws.com/send.png",alt:"chat-engine-send-button"})),o.createElement("div",{style:An.inputContainer,className:"ce-message-input-form"},o.createElement(Tn,{onSelectFiles:function(e){return v(e)}}),o.createElement(zn,{value:u,label:"Send a message...",handleChange:function(e){p(e.target.value),h((f+1)%4),1===f&&t&&(0,i.isTyping)(t,n)}.bind(Dn),onSubmit:x.bind(Dn)}))))},An={messageFormContainer:{position:"absolute",bottom:"0px",width:"100%",backgroundColor:"white"},messageForm:{paddingTop:"22px",marginRight:"10px",width:"100%"},inputContainer:{minHeight:"36px",paddingBottom:"16px",width:"100%"},sendMessage:{width:"40px",height:"40px",borderRadius:"50%",borderWidth:"0px",padding:"0px",outline:"none",color:"white",backgroundColor:"rgb(24, 144, 255)",cursor:"pointer",position:"absolute",bottom:"12px",right:"10px",zIndex:"10"},sendIcon:{width:"20px",transform:"rotate(-20deg)",marginLeft:"5px"}}}}]);